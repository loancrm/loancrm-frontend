<div>
  <div class="bread-crumb m-2">
    <p-breadcrumb [model]="breadCrumbItems"></p-breadcrumb>
  </div>
  <div class="p-1 m-2" *ngIf="userDetails">
    <div class="d-flex justify-content-between">
      <div class="pointer-cursor d-flex align-items-center" (click)="goBack()">
        <span class="me-2 d-flex align-items-center">
          <img src="../../../assets/images/icons/left-arrow.svg" alt="Back" />
        </span>
        <!-- <span class="me-2">
          <ng-container
            *ngIf="userDetails?.userImage?.length > 0; else defaultImage"
          >
            <a>
              <img
                [src]="'//' + userDetails.userImage[0]"
                alt="Image"
                class="teamImage"
                style="height: 40px; width: 40px; border-radius: 50%"
              />
            </a>
          </ng-container>
          <ng-template #defaultImage>
            <img
              src="../../../../assets/images/profile/profile.png"
              alt="Default Image"
              class="teamImage"
              style="height: 40px; width: 40px; border-radius: 50%"
            />
          </ng-template>
        </span> -->

        <b>
          <span *ngIf="userDetails.name" class="back-btn-text">
            {{ userDetails.name | capitalizeFirst }}
          </span>
        </b>
      </div>
    </div>
  </div>
  <!-- <div class="bread-crumb m-2">
    <p-breadcrumb [model]="breadCrumbItems"></p-breadcrumb>
  </div> -->
</div>
<div *ngIf="loading">
  <app-preloader></app-preloader>
</div>
<div class="bg-color">
  <div class="container-fluid mt-2" *ngIf="userDetails">
    <div class="row g-3">
      <!-- User Profile Section -->
      <div class="col-lg-8 col-md-12">
        <div class="card user-profile">
          <!-- <div class="bg-gradient">
            <i
              *ngIf="userDetails.userType !== 3"
              class="fa fa-pen-to-square update-icon"
              pTooltip="Update User"
              tooltipPosition="top"
              (click)="updateUsers(userDetails?.id)"
              title="Update"
            ></i>
          </div> -->
          <div class="bg-gradient">
            <img
              *ngIf="userDetails.userType !== 3"
              src="../../assets/images/icons/edit.svg"
              alt="Update"
              class="update-icon white-icon"
              pTooltip="Update User"
              tooltipPosition="top"
              (click)="updateUsers(userDetails?.id)"
              style="cursor: pointer; width: 20px; height: 20px"
            />
          </div>

          <div class="d-flex flex-wrap align-items-start profile-header p-3">
            <!-- Profile Image -->
            <div class="profile-img-container me-3">
              <ng-container
                *ngIf="userDetails?.userImage?.length > 0; else defaultImage"
              >
                <ng-container
                  *ngIf="isImageFile(userDetails.userImage[0]); else fileIcon"
                >
                  <a [href]="'//' + userDetails.userImage[0]" target="_blank">
                    <img
                      [src]="'//' + userDetails.userImage[0]"
                      alt="User Image"
                      class="profile-img"
                    />
                  </a>
                </ng-container>
                <ng-template #fileIcon>
                  <a [href]="'//' + userDetails.userImage[0]" target="_blank">
                    <i
                      [class]="
                        getFileIcon(userDetails.userImage[0].split('.').pop())
                      "
                      class="file-icon"
                    ></i>
                  </a>
                </ng-template>
              </ng-container>
              <ng-template #defaultImage>
                <img
                  class="profile-img"
                  src="../../../../assets/images/profile/profile.png"
                  alt="Default Profile"
                />
              </ng-template>
            </div>

            <!-- Name and Status -->
            <div class="profile-info flex-grow-1 mt-3 mt-md-0">
              <div
                class="d-flex flex-column flex-md-row justify-content-between"
              >
                <div>
                  <h4 class="card-title mb-1">
                    {{ userDetails?.name || "-" }}
                  </h4>
                  <div class="fw-medium mb-2">
                    {{ getUserRoleName(userDetails?.userType) || "-" }}
                  </div>
                </div>
                <div class="d-flex align-items-center gap-2">
                  <div class="fw-medium text-muted">Status:</div>
                  <button
                    pButton
                    pRipple
                    type="button"
                    [class.p-button-success]="userDetails?.status === 'Active'"
                    [class.p-button-danger]="userDetails?.status !== 'Active'"
                    class="custom-button"
                  >
                    {{ userDetails?.status || "-" }}
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Other Details -->
          <div class="row mt-3 px-3">
            <!-- <div class="col-md-3 col-sm-6 col-12 mb-3">
              <div class="text-muted">Password</div>
              <div class="fw-medium">
                {{
                  isPasswordVisible
                    ? userDetails?.phone
                    : maskPassword(userDetails?.phone)
                }}
                <i
                  class="pi"
                  [ngClass]="isPasswordVisible ? 'pi-eye-slash' : 'pi-eye'"
                  style="cursor: pointer; margin-left: 10px"
                  (click)="isPasswordVisible = !isPasswordVisible"
                ></i>
              </div>
            </div> -->
            <div class="col-md-3 col-sm-6 col-12 mb-3">
              <div class="text-muted">Email</div>
              <div class="fw-medium">{{ userDetails?.email || "-" }}</div>
            </div>
            <div class="col-md-3 col-sm-6 col-12 mb-3">
              <div class="text-muted">Phone Number</div>
              <div class="fw-medium">{{ userDetails?.phone || "-" }}</div>
            </div>

            <div class="col-md-3 col-sm-6 col-12 mb-3">
              <div class="text-muted">Joining Date</div>
              <div class="fw-medium">
                {{ (userDetails?.joiningDate | date) || "-" }}
              </div>
            </div>

            <div class="col-md-3 col-sm-6 col-12 mb-3">
              <div class="text-muted">Created On</div>
              <div class="fw-medium">
                {{ userDetails?.addedOn | date : "MMM d, y, h:mm a" }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Financial Summary Section -->
      <div class="col-lg-4 col-md-6 col-sm-12">
        <div
          class="card shadow-sm"
          style="background-color: #29415b; color: #ffffff"
        >
          <div class="card-body">
            <h5 class="mb-4 fw-bold" style="color: #ee7846">
              Financial Summary
            </h5>

            <div class="row">
              <!-- Sanctioned Amount -->
              <div
                class="card col-12 mb-3"
                style="
                  background-color: #455970;
                  color: #ffffff;
                  border-radius: 12px;
                "
              >
                <div class="d-flex justify-content-between align-items-center">
                  <span style="color: #fff">Sanctioned Amount</span>
                  <span
                    class="fw-bold text-end"
                    style="font-size: 18px; color: #ee7846"
                  >
                    ₹{{ totalSanctionedAmount | number }}<br />
                    <small style="color: #fff"
                      >({{ totalSanctionedAmountInLakhsOrCrores }})</small
                    >
                  </span>
                </div>
              </div>

              <!-- Disbursed Amount -->
              <div
                class="card col-12"
                style="
                  background-color: #455970;
                  color: #ffffff;
                  border-radius: 12px;
                "
              >
                <div class="d-flex justify-content-between align-items-center">
                  <span style="color: #fff">Disbursed Amount</span>
                  <span
                    class="fw-bold text-end"
                    style="font-size: 18px; color: #ee7846"
                  >
                    ₹{{ totalDisbursedAmount | number }}<br />
                    <small style="color: #fff"
                      >({{ totalDisbursedAmountInLakhsOrCrores }})</small
                    >
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="m-2">
    <p-tabMenu
      class="tabdesign"
      [model]="items"
      [activeItem]="activeItem"
      (activeItemChange)="onActiveItemChange($event)"
    ></p-tabMenu>
    <div class="mt-2">
      <div *ngIf="activeItem && activeItem.name">
        <div *ngIf="activeItem.name == 'overview'">
          <div class=" ">
            <div class="container-fluid m-2">
              <div class="row">
                <div class="col-md-6 col-12" *ngIf="pieChartOptionsforFilter">
                  <br class="d-lg-none d-md-none" />
                  <div class="chart-container">
                    <div class="chart-card p-2">
                      <app-apex-charts
                        [chartOptions]="pieChartOptionsforFilter"
                      ></app-apex-charts>
                      <span
                        *ngIf="
                          totalLeadsCount == 0 &&
                          this.totalfilesCount +
                            this.totalCreditsCount +
                            this.totalLoginsCount +
                            this.allProcessedFilesCount +
                            this.inHouseRejectsCount ==
                            0
                        "
                      >
                        <img
                          class="nodata"
                          [src]="chartDisplayMessage1"
                          alt="No Data Available"
                        />
                      </span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 col-12" *ngIf="amountBarChartOptions">
                  <br class="d-lg-none d-md-none" />
                  <div class="chart-container">
                    <div class="chart-card p-2">
                      <app-apex-charts
                        [chartOptions]="amountBarChartOptions"
                      ></app-apex-charts>
                      <span *ngIf="areAllValuesZero()">
                        <img
                          class="nodata"
                          [src]="chartDisplayMessage1"
                          alt="No Data Available"
                        />
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name === 'leads'">
          <div class="card tab-card">
            <div class="container">
              <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-2 my-3">
                  <div class="box design-card" (click)="redirectTo('leads')">
                    <div class="text-center">
                      <div class="icon-box">
                        <img
                          src="../../../../assets/images/icons/leads.svg"
                          width="60"
                        />
                      </div>
                      <div class="count-box">
                        <p>{{ totalLeadsCount }}</p>
                        <h5>New Leads</h5>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-8">
                  <div class="p-shadow-3">
                    <div class="card text-center lead-body">
                      <div class="card-body">
                        <p-timeline [value]="events" layout="horizontal">
                          <ng-template pTemplate="content" let-event>
                            <div class="timeline-event">
                              <h5>{{ event.status }}</h5>
                              <p>{{ event.description }}</p>
                            </div>
                          </ng-template>
                        </p-timeline>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-1"></div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name === 'callbacks'">
          <div class="card tab-card">
            <div class="container">
              <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-2 my-3">
                  <div
                    class="box design-card"
                    (click)="redirectTo('callbacks')"
                  >
                    <div class="text-center">
                      <div class="icon-box">
                        <img
                          src="../../../../assets/images/icons/callbacks.svg"
                          width="60"
                        />
                      </div>
                      <div class="count-box">
                        <p>{{ callBacksCount }}</p>
                        <h5>New Callbacks</h5>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-8">
                  <div class="p-shadow-3">
                    <div class="card text-center lead-body">
                      <div class="card-body">
                        <p-timeline
                          [value]="callbackevents"
                          layout="horizontal"
                        >
                          <ng-template pTemplate="content" let-event>
                            <div class="timeline-event">
                              <h5>{{ event.status }}</h5>
                              <p>{{ event.description }}</p>
                            </div>
                          </ng-template>
                        </p-timeline>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-1"></div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'files'">
          <div class="card tab-card">
            <div class="row p-5">
              <div class="col-md-2 me-4">
                <div class="box" (click)="redirectTo('files')">
                  <div class="text-center">
                    <div class="icon-box">
                      <img
                        src="../../../../assets/images/icons/files.svg"
                        width="60"
                      />
                    </div>
                    <div class="count-box">
                      <p>{{ totalfilesCount }}</p>
                      <h5>Files</h5>
                    </div>
                  </div>
                </div>
              </div>
              <!-- <div class="col-md-2 me-4">
                <div class="box" (click)="redirectTo('partial')">
                  <div class="text-center">
                    <div class="icon-box">
                      <img
                        src="../../../../assets/images/menu/partial.png"
                        width="60"
                      />
                    </div>
                    <div class="count-box">
                      <p>{{ partialsCount }}</p>
                      <h5>Partial Files</h5>
                    </div>
                  </div>
                </div>
              </div> -->
              <div class="col-md-2 me-4">
                <div class="box" (click)="redirectTo('credit')">
                  <div class="text-center">
                    <div class="icon-box">
                      <img
                        src="../../../../assets/images/icons/credit.svg"
                        width="60"
                      />
                    </div>
                    <div class="count-box">
                      <p>{{ totalCreditsCount }}</p>
                      <h5>Credit Evaluation</h5>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-2 me-4">
                <div class="box" (click)="redirectTo('logins')">
                  <div class="text-center">
                    <div class="icon-box">
                      <img
                        src="../../../../assets/images/icons/logins.svg"
                        width="60"
                      />
                    </div>
                    <div class="count-box">
                      <p>{{ totalLoginsCount }}</p>
                      <h5>Logins</h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'followups'">
          <div class="card tab-card">
            <div class="text-capitalize">
              <p-table
                #followupsTable
                [value]="followupLeads"
                [sortOrder]="-1"
                [lazy]="true"
                selectionMode="single"
                (onLazyLoad)="loadFollowupLeads($event)"
                (onRowSelect)="viewLead($event)"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                class="p-datatable-striped"
                [totalRecords]="totalFollowupLeadsCount"
                [loading]="loading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Follow Ups"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search Lead with Business Name"
                          [(ngModel)]="businessNameToSearchfollowups"
                          (ngModelChange)="
                            inputValueChangeEventfollow(
                              'loanId',
                              businessNameToSearchfollowups
                            )
                          "
                          (keyup.enter)="filterWithBusinessNamefollow()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearchfollowups"
                          (click)="filterWithBusinessNamefollow()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearchfollow"
                          (ngModelChange)="
                            inputValueChangeEventfollow(
                              'loanId',
                              mobileNumberToSearchfollow
                            )
                          "
                          (keyup.enter)="filterWithMobileNumberFollow()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearchfollow"
                          (click)="filterWithMobileNumberFollow()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <div
                            class="p-inputgroup"
                            *ngIf="
                              userDetails &&
                              userDetails.userType &&
                              userDetails.userType != '3'
                            "
                          >
                            <br class="d-lg-none d-md-none" />
                          </div>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="applyConfigFiltersFollow($event)"
                            [filterConfig]="filterConfig"
                            [showFilterIndication]="appliedFilterfollowups"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>Business Entity</th>
                    <th>Contact Person</th>
                    <th>Contact Number</th>
                    <th>City</th>
                    <th>Created Date</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessEntity"
                        >{{ getEntityName(lead.businessEntity) }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.contactPerson"
                        >{{ lead.contactPerson | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.primaryPhone">
                        {{
                          userDetails.userType == 3
                            ? getMaskedPhone(lead.primaryPhone)
                            : lead.primaryPhone
                        }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.city">{{
                        lead.city | capitalizeFirst
                      }}</span>
                    </td>

                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>

                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-primary me-2 custom-btn"
                            (click)="viewLead(lead.id)"
                          >
                            View
                          </button> -->
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-primary me-2 custom-btn"
                            (click)="viewLead(lead.id)"
                            pTooltip="View Lead"
                            icon="fas fa-eye"
                            tooltipPosition="top"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/eye.svg"
                            width="24px"
                            height="24px"
                            pTooltip="View Lead"
                            tooltipPosition="top"
                            (click)="viewLead(lead.id)"
                          />
                          <p-menu
                            appendTo="body"
                            #menu
                            [model]="actionItems(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="menu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td colspan="1" class="text-center">Remarks</td>
                    <td colspan="8">
                      <span
                        class="table-column-data col-12"
                        *ngIf="lead.remarks"
                        >{{ lead.remarks | capitalizeFirst }}</span
                      >
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center" >
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Follow Ups Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'files in process'">
          <div class="card tab-card">
            <div class="text-capitalize">
              <p-table
                #fipleadsTable
                [value]="fipleads"
                [lazy]="true"
                selectionMode="single"
                (onLazyLoad)="loadFIpLeads($event)"
                (onRowSelect)="viewLead($event)"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                [totalRecords]="totalFipLeadsCount"
                [loading]="loading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                class="p-datatable-striped"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords}  Files In Process "
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Business Name"
                          [(ngModel)]="businessNameToSearchfip"
                          (ngModelChange)="
                            inputValueChangeEventfip(
                              'loanId',
                              businessNameToSearchfip
                            )
                          "
                          (keyup.enter)="filterWithBusinessNamefip()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearchfip"
                          (click)="filterWithBusinessNamefip()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearchfip"
                          (ngModelChange)="
                            inputValueChangeEventfip(
                              'loanId',
                              mobileNumberToSearchfip
                            )
                          "
                          (keyup.enter)="filterWithMobileNumberfip()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearchfip"
                          (click)="filterWithMobileNumberfip()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2"></div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="applyConfigFiltersfip($event)"
                            [filterConfig]="filterConfig"
                            [showFilterIndication]="appliedFilterfip"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>Contact Person</th>
                    <th>Primary Phone</th>
                    <th>City</th>
                    <th>Created Date</th>
                    <th>Login Date</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.contactPerson"
                        >{{ lead.contactPerson | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.primaryPhone"
                        >{{
                          userDetails.userType == 3
                            ? getMaskedPhone(lead.primaryPhone)
                            : lead.primaryPhone
                        }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.id">
                        {{ lead.city | capitalizeFirst }}
                      </span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.loginDate">{{
                        lead.loginDate | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <p-menu
                            appendTo="body"
                            #menu
                            [model]="actionItems(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="menu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Files In Process Found</p>
                    </td>
                  </tr>
    </ng-template>
              </p-table>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'sanctions'">
          <div class="card tab-card">
            <div class="text-capitalize">
              <p-table
                #sanctionsTable
                [value]="sanctionLeads"
                [lazy]="true"
                (onLazyLoad)="loadApprovalLeads($event)"
            
                 selectionMode="single"
               
                (onRowSelect)="viewLead($event)"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                [totalRecords]="totalSanctionsCount"
                [loading]="loading"
                class="p-datatable-striped"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords}  Sanctions"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Business Name"
                          [(ngModel)]="businessNameToSearchSanctions"
                          (ngModelChange)="
                            inputValueChangeEventsanctions(
                              'loanId',
                              businessNameToSearchSanctions
                            )
                          "
                          (keyup.enter)="filterWithBusinessNameSanctions()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearchSanctions"
                          (click)="filterWithBusinessNameSanctions()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearchSanctions"
                          (ngModelChange)="
                            inputValueChangeEventsanctions(
                              'loanId',
                              mobileNumberToSearchSanctions
                            )
                          "
                          (keyup.enter)="filterWithMobileNumbersanctions()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearchSanctions"
                          (click)="filterWithMobileNumbersanctions()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2"></div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="applyConfigFiltersSanctions($event)"
                            [filterConfig]="filterConfigSanctions"
                            [showFilterIndication]="appliedFilterSanctions"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>City</th>
                    <th>Created Date</th>
                    <th>Login Date</th>
                    <th>Sanction Date</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>                  
                  <tr  [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.city">{{
                        lead.city | capitalizeFirst
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.loginDate">{{
                        lead.loginDate | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.approvalDate"
                        >{{ lead.approvalDate | date : "mediumDate" }}</span
                      >
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <p-menu
                            appendTo="body"
                            #menu
                            [model]="actionItems(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="menu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Sanctions Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'disbursals'">
          <div class="card tab-card">
            <!-- <div class="container">
              <div class="row justify-content-center text-center">
                <div class="col-md-6 d-flex justify-content-center">
                  <div class="card text-center custom-card">
                    <div class="card-body">
                      <h5 class="card-title">Sanctioned Amount</h5>
                      <h2 class="card-text">
                        {{ totalSanctionedAmount }}
                        ({{ totalSanctionedAmountInLakhsOrCrores }})
                      </h2>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 d-flex justify-content-center">
                  <div class="card text-center custom-card">
                    <div class="card-body">
                      <h5 class="card-title">Disbursed Amount</h5>
                      <h2 class="card-text">
                        {{ totalDisbursedAmount }}
                        ({{ totalDisbursedAmountInLakhsOrCrores }})
                      </h2>
                    </div>
                  </div>
                </div>
              </div>
            </div> -->
            <div class="text-capitalize mt-3">
              <p-table
                #disbursalleadsTable
                [value]="disbursalleads"
                [lazy]="true"
                (onLazyLoad)="loadDisbursalLeads($event)"
                (onRowSelect)="viewLead($event)"
                selectionMode="single"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                [totalRecords]="totalDisbursalLeadsCount"
                [loading]="loading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                class="p-datatable-striped"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords}  Disbursals"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Business Name"
                          [(ngModel)]="businessNameToSearch"
                          (ngModelChange)="
                            inputValueChangeEvent(
                              'loanId',
                              businessNameToSearch
                            )
                          "
                          (keyup.enter)="filterWithBusinessName()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearch"
                          (click)="filterWithBusinessName()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearch"
                          (ngModelChange)="
                            inputValueChangeEvent(
                              'loanId',
                              mobileNumberToSearch
                            )
                          "
                          (keyup.enter)="filterWithMobileNumber()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearch"
                          (click)="filterWithMobileNumber()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2"></div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="applyConfigFilters($event)"
                            [filterConfig]="filterConfigDisbursals"
                            [showFilterIndication]="appliedFilter"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>Sanctioned Amount</th>
                    <th>Disbursed Amount</th>
                    <th>Date</th>
                    <th>Disbursed Date</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.id">
                        {{ lead.sanctionedAmount }}
                      </span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.id">
                        {{ lead.disbursedAmount }}
                      </span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.disbursalDate"
                        >{{ lead.disbursalDate | date : "mediumDate" }}</span
                      >
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <p-menu
                            appendTo="body"
                            #menu
                            [model]="actionItems(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="menu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Disbursals Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'in House Rejects'">
          <div class="card tab-card">
            <div class="text-capitalize">
              <p-table
                #inHouseRejectsleadsTable
                [value]="inHouseRejectedleads"
                [lazy]="true"
                (onLazyLoad)="loadInhouseRejectLeads($event)"
                selectionMode="single"
                (onRowSelect)="viewLead($event)"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                [totalRecords]="inHouseRejectsCount"
                [loading]="loading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                class="p-datatable-striped"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} In House Rejects"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Business Name"
                          [(ngModel)]="businessNameToSearchInHouseReject"
                          (ngModelChange)="
                            inputValueChangeEventInHouseReject(
                              'loanId',
                              businessNameToSearchInHouseReject
                            )
                          "
                          (keyup.enter)="filterWithBusinessNameInHouseReject()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearchInHouseReject"
                          (click)="filterWithBusinessNameInHouseReject()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearchInHouseRejects"
                          (ngModelChange)="
                            inputValueChangeEventInHouseReject(
                              'loanId',
                              mobileNumberToSearchInHouseRejects
                            )
                          "
                          (keyup.enter)="filterWithMobileNumberInHouseReject()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearchInHouseRejects"
                          (click)="filterWithMobileNumberInHouseReject()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2"></div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="
                              applyConfigFiltersInHouseRejects($event)
                            "
                            [filterConfig]="filterConfig"
                            [showFilterIndication]="appliedFilterInHouseRejects"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>Contact Person</th>
                    <th>City</th>
                    <th>Date</th>
                    <th>Remarks</th>
                    <th>Status</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.contactPerson"
                        >{{ lead.contactPerson | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.city">
                        {{ lead.city | capitalizeFirst }}
                      </span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.creditSummary"
                      >
                        {{ lead.creditSummary | capitalizeFirst }}
                      </span>
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <p-menu
                            appendTo="body"
                            #menu
                            [model]="actionItems(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="menu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No In House Rejects Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'banker rejects'">
          <div class="card tab-card">
            <div class="text-capitalize">
              <p-table
                #leadsTablebank
                [value]="bankRejectLeads"
                [lazy]="true"
                (onLazyLoad)="loadBankRejectedLeads($event)"
                (onRowSelect)="viewLead($event)"
                selectionMode="single"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                [totalRecords]="bankRejectsCount"
                [loading]="loading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                class="p-datatable-striped"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Banks Rejected leads"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Business Name"
                          [(ngModel)]="businessNameToSearchforbank"
                          (ngModelChange)="
                            inputValueChangeEventforbank(
                              'loanId',
                              businessNameToSearchforbank
                            )
                          "
                          (keyup.enter)="filterWithBusinessNameforBank()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearchforbank"
                          (click)="filterWithBusinessNameforBank()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearchforbank"
                          (ngModelChange)="
                            inputValueChangeEventforbank(
                              'loanId',
                              mobileNumberToSearchforbank
                            )
                          "
                          (keyup.enter)="filterWithMobileNumberforbank()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearchforbank"
                          (click)="filterWithMobileNumberforbank()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <div class="p-inputgroup"></div>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="applyConfigFiltersforbank($event)"
                            [filterConfig]="filterConfig"
                            [showFilterIndication]="appliedFilterbankRejects"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>Contact Person</th>
                    <th>City</th>
                    <th>Created Date</th>
                    <th>Login Date</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.contactPerson"
                        >{{ lead.contactPerson | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.city">{{
                        lead.city | capitalizeFirst
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.loginDate">{{
                        lead.loginDate | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <p-menu
                            appendTo="body"
                            #bankmenu
                            [model]="actionItemsforBank(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="bankmenu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="bankmenu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Rejected Leads Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
        <div *ngIf="activeItem.name == 'cni'">
          <div class="card tab-card">
            <div class="text-capitalize">
              <p-table
                #leadsTablecni
                [value]="CniLeads"
                [lazy]="true"
                (onLazyLoad)="loadCNIRejectedLeads($event)"
                (onRowSelect)="viewLead($event)"
                selectionMode="single"
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                [totalRecords]="totalCNICount"
                [loading]="loading"
                class="p-datatable-striped"
                responsiveLayout="scroll"
                scrollHeight="flex"
                class="p-datatable-striped"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Cni leads"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Business Name"
                          [(ngModel)]="businessNameToSearchcni"
                          (ngModelChange)="
                            inputValueChangeEventcni(
                              'loanId',
                              businessNameToSearchcni
                            )
                          "
                          (keyup.enter)="filterWithBusinessNameforCNI()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!businessNameToSearchcni"
                          (click)="filterWithBusinessNameforCNI()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          placeholder="Search File with Mobile Number"
                          [(ngModel)]="mobileNumberToSearchcni"
                          (ngModelChange)="
                            inputValueChangeEventcni(
                              'loanId',
                              mobileNumberToSearchcni
                            )
                          "
                          (keyup.enter)="filterWithMobileNumbercni()"
                        />
                        <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!mobileNumberToSearchcni"
                          (click)="filterWithMobileNumbercni()"
                        ></button>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <div class="p-inputgroup"></div>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="applyConfigFiltersforcni($event)"
                            [filterConfig]="filterConfig"
                            [showFilterIndication]="appliedFilterCni"
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                  <tr>
                    <th>Lead Id</th>
                    <th>Business Name</th>
                    <th>Contact Person</th>
                    <th>City</th>
                    <th>Created Date</th>
                    <th>Login Date</th>
                    <th>Sanction Date</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td>
                      <span class="table-column-data" *ngIf="lead.leadId">{{
                        lead.id
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.businessName"
                        >{{ lead.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.contactPerson"
                        >{{ lead.contactPerson | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.city">{{
                        lead.city | capitalizeFirst
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.createdOn">{{
                        lead.createdOn | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="lead.loginDate">{{
                        lead.loginDate | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="lead.approvalDate"
                        >{{ lead.approvalDate | date : "mediumDate" }}</span
                      >
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex">
                          <p-menu
                            appendTo="body"
                            #cnimenu
                            [model]="actionItemsCNI(lead)"
                            [popup]="true"
                          ></p-menu>
                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="cnimenu.toggle($event)"
                            icon="pi pi-bars"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="cnimenu.toggle($event)"
                          />
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Rejected Leads Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
