<div>
  <div class="p-1 m-2">
    <div class="d-flex justify-content-between">
      <div
        class="d-flex align-items-center justify-content-center pointer-cursor"
        (click)="goBack()"
      >
        <span class="me-2 d-flex align-items-center">
          <img src="../../../assets/images/icons/left-arrow.svg" alt="Back" />
        </span>
        <b class="back-btn-text">Callbacks</b>
      </div>

      <!-- <div>
        <button
          pButton
          pRipple
          type="button"
          class="p-button-primary me-2"
          icon="pi pi-plus"
          (click)="createCallBack()"
        >
          &nbsp;Add Callback
        </button>
      </div> -->
      <div>
        <ng-container>
          <p-dropdown
            [options]="loanTypes"
            placeholder="Add Callback"
            [(ngModel)]="selectedLoanType"
            optionLabel="displayName"
            optionValue="name"
            (onChange)="onLoanTypeSelect($event)"
            [showClear]="true"
            appendTo="body"
            [dropdownIcon]="'fa fa-caret-down'"
            styleClass="custom-dropdown p-button-primary"
          ></p-dropdown>
        </ng-container>
      </div>
    </div>
  </div>
  <!-- <div class="bread-crumb">
    <p-breadcrumb [model]="breadCrumbItems"></p-breadcrumb>
  </div> -->
  <div class="text-capitalize m-2">
    <p-tabMenu
      [model]="items"
      class="tabdesign"
      [activeItem]="activeItem"
      (activeItemChange)="onActiveItemChange($event)"
    ></p-tabMenu>

    <div *ngIf="activeItem && activeItem.name">
      <div *ngIf="activeItem.name == 'businessLoan'" class="text-capitalize">
        <p-table
          #callBacksTable
          [value]="callBacks"
          [lazy]="true"
          class="p-datatable-striped"
          (onLazyLoad)="loadCallBacks($event)"
          dataKey="id"
          [showCurrentPageReport]="true"
          [rowsPerPageOptions]="[10, 25, 50]"
          [paginator]="true"
          [rows]="10"
          [totalRecords]="callBacksCount"
          [loading]="apiLoading"
          responsiveLayout="scroll"
          scrollHeight="flex"
          [globalFilterFields]="[
            'referenceNo',
            'customer.firstName',
            'partner.partnerName',
            'status'
          ]"
          styleClass="p-datatable-customers "
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Callbacks"
        >
          <ng-template pTemplate="caption">
            <div class="row">
              <div class="col-md-3 mt-2 no-padding-small">
                <div class="p-inputgroup">
                  <input
                    type="text"
                    pInputText
                    placeholder="Enter Business Name/Phone Number"
                    [(ngModel)]="businessNameToSearch"
                    (ngModelChange)="
                      inputValueChangeEvent('loanId', businessNameToSearch)
                    "
                    (keyup.enter)="filterWithBusinessName()"
                  />
                  <!-- <button
                    type="button"
                    pButton
                    icon="pi pi-search"
                    class="p-button-primary"
                    [disabled]="!businessNameToSearch"
                    (click)="filterWithBusinessName()"
                  ></button> -->
                  <button
                    type="button"
                    pButton
                    class="p-button-primary"
                    [disabled]="!businessNameToSearch"
                    (click)="filterWithBusinessName()"
                  >
                    <img
                      src="assets/images/icons/search.svg"
                      alt="Search"
                      width="16"
                      height="16"
                      style="vertical-align: middle"
                    />
                  </button>
                </div>
              </div>
              <div
                class="col-md-3 mt-2 no-padding-small"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType == '3'
                "
              ></div>
              <div class="col-md-3 mt-2 no-padding-small">
                <div
                  class="p-inputgroup"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  <p-dropdown
                    styleClass="text-left"
                    [style]="{ width: '100%' }"
                    [options]="leadUsers"
                    (onChange)="statusChangesourcedBy($event)"
                    [dropdownIcon]="'fa fa-caret-down'"
                    [(ngModel)]="selectedSoucedByStatus"
                    optionLabel="name"
                    dataKey="name"
                    appendTo="body"
                    [filter]="true"
                    filterPlaceholder="Search..."
                  >
                  </p-dropdown>
                </div>
              </div>
              <div class="col-md-3 mt-2 no-padding-small text-right">
                <div class="d-flex">
                  <div class="flex-grow-1 me-2">
                    <p-dropdown
                      styleClass="text-left"
                      [style]="{ width: '100%' }"
                      [options]="callbackStatus"
                      (onChange)="statusChange($event)"
                      [dropdownIcon]="'fa fa-caret-down'"
                      [(ngModel)]="selectedCallbackStatus"
                      optionLabel="displayName"
                      appendTo="body"
                      dataKey="name"
                    >
                    </p-dropdown>
                  </div>
                  <div class="d-flex align-items-center pointer-cursor">
                    <app-filter
                      [position]="'right'"
                      [iconColor]="'#33009C'"
                      [iconSize]="'28px!important'"
                      (filterEvent)="applyConfigFilters($event, '')"
                      [filterConfig]="filterConfig"
                      [showFilterIndication]="appliedFilter"
                      pTooltip="Filter"
                      tooltipPosition="top"
                    >
                    </app-filter>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th class="text-nowrap">Callback Id</th>
              <th class="text-nowrap">Business Name</th>
              <th>Phone</th>
              <th class="text-nowrap">Callback Date</th>
              <th>Remarks</th>
              <th
                class="text-nowrap"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              >
                Sourced By
              </th>
              <th class="text-nowrap">Created Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-callback>
            <tr
              class="text-capitalize"
              [ngClass]="{ 'disabled-row': callback.disabled }"
            >
              <td>
                <span class="table-column-data" *ngIf="callback.callBackId">{{
                  callback.callBackId
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.businessName">{{
                  callback.businessName | capitalizeFirst
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.phone">{{
                  callback.phone
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.date">{{
                  callback.date | date : "mediumDate"
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.remarks">{{
                  callback.remarks | capitalizeFirst
                }}</span>
              </td>
              <td
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              >
                <span class="table-column-data" *ngIf="callback.sourcedBy">{{
                  getSourceName(callback.sourcedBy) | capitalizeFirst
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.createdOn">{{
                  callback.createdOn | date : "mediumDate"
                }}</span>
              </td>
              <td>
                <span
                  class="table-column-data fw-bold statusdata"
                  *ngIf="callback.callbackInternalStatus"
                  [ngStyle]="{
                    color: getStatusColor(
                      getStatusName(callback.callbackInternalStatus)
                    ).textColor,

                  }"
                >
                  {{ getStatusName(callback.callbackInternalStatus) }}
                </span>
              </td>
              <td>
                <div
                  class="text-center d-flex pointer-cursor"
                  *ngIf="callback.callbackInternalStatus !== 3"
                >
                  <div class="d-flex">
                    <!-- <button
                      pButton
                      pRipple
                      type="button"
                      class="p-button-primary custom-btn"
                      (click)="updateCallBack(callback.id)"
                      pTooltip="Update Callback"
                      icon="fas fa-pen-to-square"
                      tooltipPosition="top"
                    ></button> -->
                    <img
                      src="../../../assets/images/icons/edit.svg"
                      width="24px"
                      height="24px"
                      class="me-2"
                      (click)="updateCallBack(callback.id)"
                      pTooltip="Update Callback"
                      tooltipPosition="top"
                    />
                  </div>
                  <p-menu
                    appendTo="body"
                    #menu
                    [model]="actionItems(callback, '')"
                    [popup]="true"
                  ></p-menu>
                  <!-- <button
                    pButton
                    type="button"
                    class="custom-btn"
                    (click)="menu.toggle($event)"
                    icon="fas fa-bars"
                    pTooltip="Actions"
                    tooltipPosition="top"
                  ></button> -->

                  <img
                    src="../../../assets/images/icons/menu.svg"
                    width="24px"
                    height="24px"
                    pTooltip="Actions"
                    tooltipPosition="top"
                    (click)="menu.toggle($event)"
                  />
                </div>
                <div
                  class="text-center d-flex pointer-cursor"
                  *ngIf="callback.callbackInternalStatus == 3"
                >
                  <!-- <button
                    pButton
                    pRipple
                    type="button"
                    class="p-button-primary me-2 custom-btn"
                    (click)="viewLead(callback)"
                    pTooltip="View Lead"
                    icon="fas fa-eye"
                    tooltipPosition="top"
                  ></button> -->
                  <img
                    src="../../../assets/images/icons/eye.svg"
                    width="24px"
                    height="24px"
                    pTooltip="View Lead"
                    tooltipPosition="top"
                    (click)="viewLead(callback)"
                  />
                </div>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr class="text-center">
              <td colspan="10" class="text-center fw-bold">
                <img
                  src="../../../assets/images/menu/no-data.gif"
                  width="200"
                  height="200"
                />
                <p>No Callbacks Found</p>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>

      <div *ngIf="activeItem.name == 'personalLoan'" class="text-capitalize">
        <p-table
          #personalcallBacksTable
          [value]="callBacks"
          [lazy]="true"
          class="p-datatable-striped"
          (onLazyLoad)="loadPersonalLoanCallBacks($event)"
          dataKey="id"
          [showCurrentPageReport]="true"
          [rowsPerPageOptions]="[10, 25, 50]"
          [paginator]="true"
          [rows]="10"
          [totalRecords]="callBacksCount"
          [loading]="apiLoading"
          responsiveLayout="scroll"
          scrollHeight="flex"
          [globalFilterFields]="[
            'referenceNo',
            'customer.firstName',
            'partner.partnerName',
            'status'
          ]"
          styleClass="p-datatable-customers "
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Callbacks"
        >
          <ng-template pTemplate="caption">
            <div class="row">
              <div class="col-md-3 mt-2 no-padding-small">
                <div class="p-inputgroup">
                  <input
                    type="text"
                    pInputText
                    placeholder="Enter Person Name/Phone Number"
                    [(ngModel)]="personNameToSearch"
                    (ngModelChange)="
                      inputValueChangeEventForPersonal(
                        'loanId',
                        personNameToSearch
                      )
                    "
                    (keyup.enter)="filterWithPersonName()"
                  />
                  <!-- <button
                    type="button"
                    pButton
                    icon="pi pi-search"
                    class="p-button-primary"
                    [disabled]="!personNameToSearch"
                    (click)="filterWithPersonName()"
                  ></button> -->
                  <button
                    type="button"
                    pButton
                    class="p-button-primary"
                    [disabled]="!personNameToSearch"
                    (click)="filterWithPersonName()"
                  >
                    <img
                      src="assets/images/icons/search.svg"
                      alt="Search"
                      width="16"
                      height="16"
                      style="vertical-align: middle"
                    />
                  </button>
                </div>
              </div>
              <div
                class="col-md-3 mt-2 no-padding-small"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType == '3'
                "
              ></div>
              <div class="col-md-3 mt-2 no-padding-small">
                <div
                  class="p-inputgroup"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  <br class="d-lg-none d-md-none" />
                  <p-dropdown
                    styleClass="text-left"
                    [style]="{ width: '100%' }"
                    [options]="leadUsers"
                    (onChange)="statusChangeForPersonal($event)"
                    [dropdownIcon]="'fa fa-caret-down'"
                    [(ngModel)]="SourcedByForPersonal"
                    optionLabel="name"
                    dataKey="name"
                    appendTo="body"
                    [filter]="true"
                    filterPlaceholder="Search..."
                  >
                  </p-dropdown>
                </div>
              </div>
              <div class="col-md-3 mt-2 no-padding-small text-right">
                <div class="d-flex">
                  <div class="flex-grow-1 me-2">
                    <p-dropdown
                      styleClass="text-left"
                      [style]="{ width: '100%' }"
                      [options]="callbackStatus"
                      (onChange)="statusChangeForPersonal1($event)"
                      [dropdownIcon]="'fa fa-caret-down'"
                      [(ngModel)]="selectedPersonalCallbackStatus"
                      optionLabel="displayName"
                      appendTo="body"
                      dataKey="name"
                    >
                    </p-dropdown>
                  </div>
                  <div class="d-flex align-items-center pointer-cursor">
                    <app-filter
                      [position]="'right'"
                      [iconColor]="'#33009C'"
                      [iconSize]="'28px!important'"
                      (filterEvent)="applyConfigFilters($event, 'Personal')"
                      [filterConfig]="personalfilterConfig"
                      [showFilterIndication]="appliedFilterPersonal"
                      pTooltip="Filter"
                      tooltipPosition="top"
                    >
                    </app-filter>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th class="text-nowrap">Callback Id</th>
              <th class="text-nowrap">Person Name</th>
              <th>Phone</th>
              <th class="text-nowrap">Callback Date</th>
              <th>Remarks</th>
              <th
                class="text-nowrap"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              >
                Sourced By
              </th>
              <th class="text-nowrap">Created Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-callback>
            <tr
              class="text-capitalize"
              [ngClass]="{ 'disabled-row': callback.disabled }"
            >
              <td>
                <span class="table-column-data" *ngIf="callback.callBackId">{{
                  callback.callBackId
                }}</span>
              </td>
              <td>
                <b>
                  <span
                    class="table-column-data"
                    *ngIf="callback.businessName"
                    >{{ callback.businessName | capitalizeFirst }}</span
                  >
                </b>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.phone">{{
                  callback.phone
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.date">{{
                  callback.date | date : "mediumDate"
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.remarks">{{
                  callback.remarks | capitalizeFirst
                }}</span>
              </td>
              <td
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              >
                <span class="table-column-data" *ngIf="callback.sourcedBy">{{
                  getSourceName(callback.sourcedBy) | capitalizeFirst
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.createdOn">{{
                  callback.createdOn | date : "mediumDate"
                }}</span>
              </td>
              <td>
                <span
                  class="table-column-data fw-bold statusdata"
                  *ngIf="callback.callbackInternalStatus"
                  [ngStyle]="{
                    color: getStatusColor(
                      getStatusName(callback.callbackInternalStatus)
                    ).textColor,
                  }"
                >
                  {{ getStatusName(callback.callbackInternalStatus) }}
                </span>
              </td>
              <td>
                <div
                  class="text-center d-flex pointer-cursor"
                  *ngIf="callback.callbackInternalStatus !== 3"
                >
                  <div class="d-flex">
                    <!-- <button
                      pButton
                      pRipple
                      type="button"
                      class="p-button-primary custom-btn"
                      (click)="updateCallBack(callback.id)"
                      pTooltip="Update Callback"
                      icon="fas fa-pen-to-square"
                      tooltipPosition="top"
                    ></button> -->
                    <img
                      src="../../../assets/images/icons/edit.svg"
                      width="24px"
                      height="24px"
                      class="me-2"
                      (click)="updateCallBack(callback.id)"
                      pTooltip="Update Callback"
                      tooltipPosition="top"
                    />
                  </div>
                  <p-menu
                    appendTo="body"
                    #menu
                    [model]="actionItems(callback, 'personal')"
                    [popup]="true"
                  ></p-menu>
                  <!-- <button
                    pButton
                    type="button"
                    class="custom-btn"
                    (click)="menu.toggle($event)"
                    icon="fas fa-bars"
                    pTooltip="Actions"
                    tooltipPosition="top"
                  ></button> -->
                  <img
                    src="../../../assets/images/icons/menu.svg"
                    width="24px"
                    height="24px"
                    pTooltip="Actions"
                    tooltipPosition="top"
                    (click)="menu.toggle($event)"
                  />
                </div>
                <div
                  class="text-center d-flex pointer-cursor"
                  *ngIf="callback.callbackInternalStatus == 3"
                >
                  <!-- <button
                    pButton
                    pRipple
                    type="button"
                    class="p-button-primary me-2 custom-btn"
                    (click)="viewLead(callback)"
                    pTooltip="View Lead"
                    icon="fas fa-eye"
                    tooltipPosition="top"
                  ></button> -->
                  <img
                    src="../../../assets/images/icons/eye.svg"
                    width="24px"
                    height="24px"
                    class="me-2"
                    (click)="viewLead(callback)"
                    pTooltip="View Lead"
                    tooltipPosition="top"
                  />
                </div>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr class="text-center">
              <td colspan="10" class="text-center fw-bold">
                <img
                  src="../../../assets/images/menu/no-data.gif"
                  width="200"
                  height="200"
                />
                <p>No Callbacks Found</p>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
      <div *ngIf="activeItem.name == 'homeLoan'">
        <p-tabMenu
          [model]="employmentStatus"
          class="tabdesign"
          [activeItem]="activeEmploymentStatus"
          (activeItemChange)="onActiveEmploymentStatusChange($event)"
        ></p-tabMenu>
        <ng-container
          *ngIf="activeEmploymentStatus && activeEmploymentStatus.name"
        >
          <ng-container
            *ngIf="
              activeEmploymentStatus.name == 'employed' ||
              activeEmploymentStatus.name == 'self-employed'
            "
          >
            <div class="text-capitalize">
              <p-table
                #HomecallBacksTable
                [value]="callBacks"
                [sortOrder]="-1"
                [lazy]="true"
                (onLazyLoad)="
                  activeEmploymentStatus.name == 'employed'
                    ? loadHomeLoanCallBacks($event)
                    : loadHomeLoanSelfCallBacks($event)
                "
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                class="p-datatable-striped"
                [totalRecords]="callBacksCount"
                [loading]="apiLoading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Callbacks"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          [placeholder]="
                            activeEmploymentStatus.name === 'employed'
                              ? 'Search Lead with Person Name'
                              : 'Search Lead with Business Name'
                          "
                          [(ngModel)]="searchInputValue"
                          (ngModelChange)="handleInputChange($event)"
                          (keyup.enter)="filterBasedOnEmploymentStatus()"
                        />
                        <!-- <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        ></button> -->
                        <button
                          type="button"
                          pButton
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="assets/images/icons/search.svg"
                            alt="Search"
                            width="16"
                            height="16"
                            style="vertical-align: middle"
                          />
                        </button>
                      </div>
                    </div>
                    <div
                      class="col-md-3 mt-2 no-padding-small"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType == '3'
                      "
                    ></div>
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div
                        class="p-inputgroup"
                        *ngIf="
                          userDetails &&
                          userDetails.userType &&
                          userDetails.userType != '3'
                        "
                      >
                        <br class="d-lg-none d-md-none" />
                        <p-dropdown
                          styleClass="text-left"
                          [style]="{ width: '100%' }"
                          [options]="leadUsers"
                          (onChange)="
                            activeEmploymentStatus.name === 'employed'
                              ? sourcedByChangeForHome($event)
                              : sourcedByChangeForHomeSelf($event)
                          "
                          [dropdownIcon]="'fa fa-caret-down'"
                          [(ngModel)]="SourcedByForHome"
                          optionLabel="name"
                          dataKey="name"
                          [filter]="true"
                          appendTo="body"
                          filterPlaceholder="Search..."
                        >
                        </p-dropdown>
                      </div>
                    </div>
                    <div class="col-md-3 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <p-dropdown
                            styleClass="text-left"
                            [style]="{ width: '100%' }"
                            [options]="callbackStatus"
                            (onChange)="
                              activeEmploymentStatus.name === 'employed'
                                ? statusChangeForHome($event)
                                : statusChangeForHomeSelf($event)
                            "
                            [dropdownIcon]="'fa fa-caret-down'"
                            [(ngModel)]="selectedHomeCallbackStatus"
                            optionLabel="displayName"
                            dataKey="name"
                            appendTo="body"
                          >
                          </p-dropdown>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="
                              activeEmploymentStatus.name === 'employed'
                                ? applyConfigFilters($event, 'Home')
                                : applyConfigFilters($event, 'Homeself')
                            "
                            [filterConfig]="
                              activeEmploymentStatus.name === 'employed'
                                ? HomefilterConfig
                                : HomeSelffilterConfig
                            "
                            [showFilterIndication]="
                              activeEmploymentStatus.name === 'employed'
                                ? appliedFilterHome
                                : appliedFilterHomeself
                            "
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th class="text-nowrap">Callback Id</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Person Name
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Name
                    </th>
                    <th>Phone</th>
                    <th class="text-nowrap">Callback Date</th>
                    <th>Remarks</th>
                    <th
                      class="text-nowrap"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      Sourced By
                    </th>
                    <th class="text-nowrap">Created Date</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-callback>
                  <tr>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.callBackId"
                        >{{ callback.callBackId }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.businessName"
                        >{{ callback.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="callback.phone">{{
                        callback.phone
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="callback.date">{{
                        callback.date | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.remarks"
                        >{{ callback.remarks | capitalizeFirst }}</span
                      >
                    </td>
                    <td
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      <span
                        class="table-column-data"
                        *ngIf="callback.sourcedBy"
                        >{{
                          getSourceName(callback.sourcedBy) | capitalizeFirst
                        }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.createdOn"
                        >{{ callback.createdOn | date : "mediumDate" }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data fw-bold statusdata"
                        *ngIf="callback.callbackInternalStatus"
                        [ngStyle]="{
                          color: getStatusColor(
                            getStatusName(callback.callbackInternalStatus)
                          ).textColor,
                        }"
                      >
                        {{ getStatusName(callback.callbackInternalStatus) }}
                      </span>
                    </td>
                    <td>
                      <div
                        class="text-center d-flex pointer-cursor"
                        *ngIf="callback.callbackInternalStatus !== 3"
                      >
                        <div class="d-flex">
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-primary custom-btn"
                            (click)="updateCallBack(callback.id)"
                            pTooltip="Update Callback"
                            icon="fas fa-pen-to-square"
                            tooltipPosition="top"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/edit.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            (click)="updateCallBack(callback.id)"
                            pTooltip="Update Callback"
                            tooltipPosition="top"
                          />
                        </div>
                        <p-menu
                          appendTo="body"
                          #menu
                          [model]="getHomeActionItems(callback)"
                          [popup]="true"
                        ></p-menu>
                        <!-- <button
                          pButton
                          type="button"
                          class="custom-btn"
                          (click)="menu.toggle($event)"
                          icon="fas fa-bars"
                          pTooltip="Actions"
                          tooltipPosition="top"
                        ></button> -->
                        <img
                          src="../../../assets/images/icons/menu.svg"
                          width="24px"
                          height="24px"
                          pTooltip="Actions"
                          tooltipPosition="top"
                          (click)="menu.toggle($event)"
                        />
                      </div>
                      <div
                        class="text-center d-flex"
                        *ngIf="callback.callbackInternalStatus == 3"
                      >
                        <!-- <button
                          pButton
                          pRipple
                          type="button"
                          class="p-button-primary me-2 custom-btn"
                          (click)="viewLead(callback)"
                          pTooltip="View Lead"
                          icon="fas fa-eye"
                          tooltipPosition="top"
                        ></button> -->
                        <img
                          src="../../../assets/images/icons/eye.svg"
                          width="24px"
                          height="24px"
                          class="me-2"
                          (click)="viewLead(callback)"
                          pTooltip="View Lead"
                          tooltipPosition="top"
                        />
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Callbacks Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </ng-container>
        </ng-container>
      </div>
      <div *ngIf="activeItem.name == 'lap'">
        <p-tabMenu
          [model]="employmentStatus"
          class="tabdesign"
          [activeItem]="activeEmploymentStatus"
          (activeItemChange)="onActiveEmploymentStatusChange($event)"
        ></p-tabMenu>
        <ng-container
          *ngIf="activeEmploymentStatus && activeEmploymentStatus.name"
        >
          <ng-container
            *ngIf="
              activeEmploymentStatus.name == 'employed' ||
              activeEmploymentStatus.name == 'self-employed'
            "
          >
            <div class="text-capitalize">
              <p-table
                #LapcallBacksTable
                [value]="callBacks"
                [sortOrder]="-1"
                [lazy]="true"
                (onLazyLoad)="
                  activeEmploymentStatus.name == 'employed'
                    ? loadLAPCallBacks($event)
                    : loadLAPSelfCallBacks($event)
                "
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                class="p-datatable-striped"
                [totalRecords]="callBacksCount"
                [loading]="apiLoading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Callbacks"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          [placeholder]="
                            activeEmploymentStatus.name === 'employed'
                              ? 'Search Lead with Person Name'
                              : 'Search Lead with Business Name'
                          "
                          [(ngModel)]="searchInputValue"
                          (ngModelChange)="handleInputChange($event)"
                          (keyup.enter)="filterBasedOnEmploymentStatus()"
                        />
                        <!-- <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        ></button> -->
                        <button
                          type="button"
                          pButton
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="assets/images/icons/search.svg"
                            alt="Search"
                            width="16"
                            height="16"
                            style="vertical-align: middle"
                          />
                        </button>
                      </div>
                    </div>
                    <div
                      class="col-md-3 mt-2 no-padding-small"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType == '3'
                      "
                    ></div>
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div
                        class="p-inputgroup"
                        *ngIf="
                          userDetails &&
                          userDetails.userType &&
                          userDetails.userType != '3'
                        "
                      >
                        <br class="d-lg-none d-md-none" />
                        <p-dropdown
                          styleClass="text-left"
                          [style]="{ width: '100%' }"
                          [options]="leadUsers"
                          (onChange)="
                            activeEmploymentStatus.name === 'employed'
                              ? sourcedByChangeForLap($event)
                              : sourcedByChangeForLapSelf($event)
                          "
                          [dropdownIcon]="'fa fa-caret-down'"
                          [(ngModel)]="SourcedByForLap"
                          optionLabel="name"
                          dataKey="name"
                          appendTo="body"
                          [filter]="true"
                          filterPlaceholder="Search..."
                        >
                        </p-dropdown>
                      </div>
                    </div>
                    <div class="col-md-3 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <p-dropdown
                            styleClass="text-left"
                            [style]="{ width: '100%' }"
                            [options]="callbackStatus"
                            (onChange)="
                              activeEmploymentStatus.name === 'employed'
                                ? statusChangeForLap($event)
                                : statusChangeForLapSelf($event)
                            "
                            [dropdownIcon]="'fa fa-caret-down'"
                            [(ngModel)]="selectedLapCallbackStatus"
                            optionLabel="displayName"
                            dataKey="name"
                            appendTo="body"
                          >
                          </p-dropdown>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="
                              activeEmploymentStatus.name === 'employed'
                                ? applyConfigFilters($event, 'Lap')
                                : applyConfigFilters($event, 'Lapself')
                            "
                            [filterConfig]="
                              activeEmploymentStatus.name === 'employed'
                                ? HomefilterConfig
                                : HomeSelffilterConfig
                            "
                            [showFilterIndication]="
                              activeEmploymentStatus.name === 'employed'
                                ? appliedFilterLap
                                : appliedFilterLapself
                            "
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th class="text-nowrap">Callback Id</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Person Name
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Name
                    </th>

                    <th>Phone</th>
                    <th class="text-nowrap">Callback Date</th>
                    <th>Remarks</th>
                    <th
                      class="text-nowrap"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      Sourced By
                    </th>
                    <th class="text-nowrap">Created Date</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-callback>
                  <tr>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.callBackId"
                        >{{ callback.callBackId }}</span
                      >
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span
                        class="table-column-data"
                        *ngIf="callback.businessName"
                        >{{ callback.businessName | capitalizeFirst }}</span
                      >
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span
                        class="table-column-data"
                        *ngIf="callback.businessName"
                        >{{ callback.businessName | capitalizeFirst }}</span
                      >
                    </td>

                    <td>
                      <span class="table-column-data" *ngIf="callback.phone">{{
                        callback.phone
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data" *ngIf="callback.date">{{
                        callback.date | date : "mediumDate"
                      }}</span>
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.remarks"
                        >{{ callback.remarks | capitalizeFirst }}</span
                      >
                    </td>
                    <td
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      <span
                        class="table-column-data"
                        *ngIf="callback.sourcedBy"
                        >{{
                          getSourceName(callback.sourcedBy) | capitalizeFirst
                        }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data"
                        *ngIf="callback.createdOn"
                        >{{ callback.createdOn | date : "mediumDate" }}</span
                      >
                    </td>
                    <td>
                      <span
                        class="table-column-data fw-bold statusdata"
                        *ngIf="callback.callbackInternalStatus"
                        [ngStyle]="{
                          color: getStatusColor(
                            getStatusName(callback.callbackInternalStatus)
                          ).textColor,

                        }"
                      >
                        {{ getStatusName(callback.callbackInternalStatus) }}
                      </span>
                    </td>
                    <td>
                      <div
                        class="text-center d-flex pointer-cursor"
                        *ngIf="callback.callbackInternalStatus !== 3"
                      >
                        <div class="d-flex">
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-primary custom-btn"
                            (click)="updateCallBack(callback.id)"
                            pTooltip="Update Callback"
                            icon="fas fa-pen-to-square"
                            tooltipPosition="top"
                          ></button> -->
                          <img
                            src="../../../assets/images/icons/edit.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            (click)="updateCallBack(callback.id)"
                            pTooltip="Update Callback"
                            tooltipPosition="top"
                          />
                        </div>
                        <p-menu
                          appendTo="body"
                          #menu
                          [model]="getLapActionItems(callback)"
                          [popup]="true"
                        ></p-menu>
                        <!-- <button
                          pButton
                          type="button"
                          class="custom-btn"
                          (click)="menu.toggle($event)"
                          icon="fas fa-bars"
                          pTooltip="Actions"
                          tooltipPosition="top"
                        ></button> -->
                        <img
                          src="../../../assets/images/icons/menu.svg"
                          width="24px"
                          height="24px"
                          pTooltip="Actions"
                          tooltipPosition="top"
                          (click)="menu.toggle($event)"
                        />
                      </div>
                      <div
                        class="text-center d-flex"
                        *ngIf="callback.callbackInternalStatus == 3"
                      >
                        <!-- <button
                          pButton
                          pRipple
                          type="button"
                          class="p-button-primary me-2 custom-btn"
                          (click)="viewLead(callback)"
                          pTooltip="View Lead"
                          icon="fas fa-eye"
                          tooltipPosition="top"
                        ></button> -->
                        <img
                          src="../../../assets/images/icons/eye.svg"
                          width="24px"
                          height="24px"
                          class="me-2"
                          (click)="viewLead(callback)"
                          pTooltip="View Lead"
                          tooltipPosition="top"
                        />
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <img
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      />
                      <p>No Callbacks Found</p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </ng-container>
        </ng-container>
      </div>
      <div *ngIf="activeItem.name == 'professionalLoans'">
        <p>Comming soon ....</p>
      </div>
      <div *ngIf="activeItem.name == 'educationlLoans'">
        <p>Comming soon ....</p>
      </div>
      <div *ngIf="activeItem.name == 'carLoan'">
        <p>Comming soon ....</p>
      </div>

      <!-- <div
        *ngIf="activeItem.name == 'convertedCallbacks'"
        class="text-capitalize"
      >
        <p-table
          #convertedcallBacksTable
          [value]="callBacks"
          [lazy]="true"
          class="p-datatable-striped"
          (onLazyLoad)="loadConvertedCallBacks($event)"
          dataKey="id"
          [showCurrentPageReport]="true"
          [rowsPerPageOptions]="[10, 25, 50]"
          [paginator]="true"
          [rows]="10"
          [totalRecords]="callBacksCount"
          [loading]="apiLoading"
          responsiveLayout="scroll"
          scrollHeight="flex"
          [globalFilterFields]="[
            'referenceNo',
            'customer.firstName',
            'partner.partnerName',
            'status'
          ]"
          styleClass="p-datatable-customers "
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Converted Leads"
        >
          <ng-template pTemplate="caption">
            <div class="row">
              <div
                class="col-md-4 mt-2 no-padding-small"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType == '3'
                "
              >
                <div class="p-inputgroup">
                  <input
                    type="text"
                    pInputText
                    placeholder="Search Callback with Business Name"
                    [(ngModel)]="businessNameConvertedCallback"
                    (ngModelChange)="
                      inputValueChangeEventConvertedCallback(
                        'loanId',
                        businessNameConvertedCallback
                      )
                    "
                    (keyup.enter)="filterWithBusinessNameConverted()"
                  />
                  <button
                    type="button"
                    pButton
                    icon="pi pi-search"
                    class="p-button-primary"
                    [disabled]="!businessNameConvertedCallback"
                    (click)="filterWithBusinessNameConverted()"
                  ></button>
                </div>
              </div>
              <div class="col-md-4 mt-2 no-padding-small">
                <div
                  class="p-inputgroup"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  <br class="d-lg-none d-md-none" />
                  <p-dropdown
                    styleClass="text-left"
                    [style]="{ width: '100%' }"
                    [options]="leadUsers"
                    (onChange)="statusChangeConverted($event)"
                    [dropdownIcon]="'fa fa-caret-down'"
                    [(ngModel)]="selectedSoucedByConverted"
                    optionLabel="name"
                    dataKey="name"
                    appendTo="body"
                    [filter]="true"
                    filterPlaceholder="Search..."
                  >
                  </p-dropdown>
                </div>
              </div>
              <div
                class="col-md-4 mt-2 no-padding-small"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              ></div>
              <div class="col-md-4 mt-2 no-padding-small text-right">
                <div class="d-flex">
                  <div class="flex-grow-1 me-2"></div>
                  <div class="d-flex align-items-center pointer-cursor">
                    <app-filter
                      [position]="'right'"
                      [iconColor]="'#33009C'"
                      [iconSize]="'28px!important'"
                      (filterEvent)="applyConfigFiltersConverted($event)"
                      [filterConfig]="filterConfig"
                      [showFilterIndication]="appliedFilterConverted"
                           pTooltip="Filter"
                        tooltipPosition="top"
                    >
                    </app-filter>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th class="text-nowrap">Callback Id</th>
              <th class="text-nowrap">Lead Id</th>
              <th class="text-nowrap">Business Name</th>
              <th>Phone</th>
              <th class="text-nowrap">Callback Date</th>
              <th>Remarks</th>
              <th
                class="text-nowrap"
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              >
                Sourced By
              </th>
              <th class="text-nowrap">Created Date</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-callback>
            <tr
              class="text-capitalize"
              [ngClass]="{ 'disabled-row': callback.disabled }"
            >
              <td>
                <span class="table-column-data" *ngIf="callback.callBackId">{{
                  callback.callBackId
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.referenceNo">{{
                  callback.referenceNo
                }}</span>
              </td>
              <td>
                <b>
                  <span
                    class="table-column-data"
                    *ngIf="callback.businessName"
                    >{{ callback.businessName | capitalizeFirst }}</span
                  >
                </b>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.phone">{{
                  callback.phone
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.date">{{
                  callback.date | date : "mediumDate"
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.remarks">{{
                  callback.remarks | capitalizeFirst
                }}</span>
              </td>
              <td
                *ngIf="
                  userDetails &&
                  userDetails.userType &&
                  userDetails.userType != '3'
                "
              >
                <span class="table-column-data" *ngIf="callback.sourcedBy">{{
                  getSourceName(callback.sourcedBy) | capitalizeFirst
                }}</span>
              </td>
              <td>
                <span class="table-column-data" *ngIf="callback.createdOn">{{
                  callback.createdOn | date : "mediumDate"
                }}</span>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr class="text-center">
              <td colspan="10" class="text-center fw-bold">
                <img
                  src="../../../assets/images/menu/no-data.gif"
                  width="200"
                  height="200"
                />
                <p>No Converted Leads Found</p>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div> -->
    </div>
  </div>
</div>
