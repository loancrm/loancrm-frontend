<!-- <div *ngIf="loading">
  <app-preloader></app-preloader>
</div>

<div
  *ngIf="!loading && selectedReportConfig && selectedReportConfig.fields"
  class="no-select"
>
  <div class="card">
    <div (click)="goBack()" class="pointer-cursor">
      <span><i class="pi pi-arrow-left fw-bold"></i></span>&nbsp;
      <span
        *ngIf="selectedReportConfig.reportName"
        class="back-btn-text fw-bold"
        >{{ selectedReportConfig.reportName }} Report</span
      >
    </div>
  </div>

  <div>
    <p-breadcrumb [model]="breadCrumbItems"></p-breadcrumb>
  </div>
  <div class="card report-fields mt-2">
    <div class="row">
      <ng-container
        class="create mt-1"
        *ngFor="let field of selectedReportConfig.fields; let i = index"
      >
        <div class="col-xl-3 col-md-4 col-sm-6 mt-2">
          <label [htmlFor]="field.field" *ngIf="!field.disabled">{{
            field.title
          }}</label>
          <input
            pInputText
            [id]="field.field"
            [placeholder]="'Enter ' + field.title"
            autocomplete="off"
            [(ngModel)]="reportData[field.field + '-' + field.filterType]"
            *ngIf="field && field.type == 'text'"
            [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
          />
          <input
            pInputText
            [id]="field.field"
            [placeholder]="'Enter ' + field.title"
            autocomplete="off"
            [(ngModel)]="reportData[field.field + '-' + field.filterType]"
            *ngIf="field && field.type == 'number'"
            [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
            (keypress)="onNumberInputChange($event)"
          />
          <span *ngIf="field && field.type == 'date'">
            <p-calendar
              [placeholder]="'Select ' + field.title"
              appendTo="body"
              [showIcon]="true"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [dateFormat]="field.dateFormat ? field.dateFormat : 'dd/mm/yy'"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [readonlyInput]="true"
            ></p-calendar>
          </span>
          <span *ngIf="field && field.type == 'dropdown'">
            <p-dropdown
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [options]="field.options"
              [optionValue]="field.value"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [optionLabel]="field.label"
              appendTo="body"
              [dropdownIcon]="'fa fa-caret-down'"
              [autoDisplayFirst]="field.autoDisplayFirst ? true : false"
              [filter]="field.showFilter ? true : false"
            >
            </p-dropdown>
          </span>
          <span *ngIf="field && field.type == 'timePeriod' && !field.disabled">
            <p-dropdown
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [options]="field.options"
              [optionValue]="field.value"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [optionLabel]="field.label"
              appendTo="body"
              [dropdownIcon]="'fa fa-caret-down'"
              [autoDisplayFirst]="false"
              [filter]="field.showFilter ? true : false"
              (onChange)="onTimePeriodChange($event, field, i)"
              [disabled]="field.disabled"
            >
            </p-dropdown>
          </span>

          <span *ngIf="field && field.type == 'multiselect'">
            <p-multiSelect
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [dropdownIcon]="'fa fa-caret-down'"
              [options]="field.options"
              appendTo="body"
              [optionValue]="field.value"
              [optionLabel]="field.label"
            ></p-multiSelect>
          </span>
          <span *ngIf="field && field.type == 'page'">
            <div class="d-flex">
              <div class="flex-grow-1 right-border-rad">
                <input
                  pInputText
                  [class.disable-field]="true"
                  [placeholder]="'Select ' + field.title"
                  autocomplete="off"
                  [value]="
                    getLabelsFromData(
                      field,
                      reportData[field.field + '-' + field.filterType]
                    )
                  "
                  [style]="{
                    width: field.fieldWidth ? field.fieldWidth : '100%'
                  }"
                />
              </div>
              <div class="create d-flex left-border-rad">
                <button pButton pRipple class="btn btn-primary">Change</button>
              </div>
            </div>
          </span>
        </div>
      </ng-container>
    </div>
    <div class="mt-3 text-center">
      <div class="d-md-flex justify-content-center">
        <div class="mt-2">
          <button
            pButton
            pRipple
            class="p-button-primary me-2"
            (click)="generateReport(selectedReportConfig.reportType)"
          >
            Generate Report
          </button>
        </div>
      </div>
    </div>
  </div>
</div> -->

<div *ngIf="loading">
  <app-preloader></app-preloader>
</div>

<div
  *ngIf="!loading && selectedReportConfig && selectedReportConfig.fields"
  class="no-select"
>
  <div class="p-1 m-2">
    <div class="d-flex justify-content-between">
      <div
        (click)="goBack()"
        class="d-flex align-items-center justify-content-center pointer-cursor"
      >
        <span class="me-2 d-flex align-items-center">
          <img src="../../../assets/images/icons/left-arrow.svg" alt="Back" />
        </span>
        <!-- <span class="me-1">
        <img
          src="../../../../assets/images/menu/reports.png"
          alt="Default Image"
          class=""
          style="height: 35px; width: 40px"
        />
      </span> -->
        <b>
          <span
            *ngIf="selectedReportConfig.reportName"
            class="back-btn-text fw-bold"
            >{{ selectedReportConfig.reportName }} Report
          </span>
        </b>
      </div>
    </div>
  </div>

  <div class="bread-crumb m-2">
    <p-breadcrumb [model]="breadCrumbItems"></p-breadcrumb>
  </div>
  <div class="card report-fields m-2">
    <div class="row">
      <ng-container
        class="create mt-1"
        *ngFor="let field of selectedReportConfig.fields; let i = index"
      >
        <div class="col-xl-3 col-md-4 col-sm-6 mt-2">
          <label [htmlFor]="field.field" *ngIf="!field.disabled">{{
            field.title
          }}</label>
          <input
            pInputText
            [id]="field.field"
            [placeholder]="'Enter ' + field.title"
            autocomplete="off"
            [(ngModel)]="reportData[field.field + '-' + field.filterType]"
            *ngIf="field && field.type == 'text'"
            [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
          />
          <input
            pInputText
            [id]="field.field"
            [placeholder]="'Enter ' + field.title"
            autocomplete="off"
            [(ngModel)]="reportData[field.field + '-' + field.filterType]"
            *ngIf="field && field.type == 'number'"
            [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
            (keypress)="onNumberInputChange($event)"
          />
          <span *ngIf="field && field.type == 'date'">
            <p-calendar
              [placeholder]="'Select ' + field.title"
              appendTo="body"
              [showIcon]="true"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [dateFormat]="field.dateFormat ? field.dateFormat : 'dd/mm/yy'"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [readonlyInput]="true"
              [showButtonBar]="true"
            ></p-calendar>
          </span>
          <span *ngIf="field && field.type == 'dropdown'">
            <!-- <p-dropdown
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [options]="field.options"
              [optionValue]="field.value"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [optionLabel]="field.label"
              appendTo="body"
              [showClear]="true"
              [dropdownIcon]="'fa fa-caret-down'"
              [autoDisplayFirst]="field.autoDisplayFirst ? true : false"
              [filter]="field.showFilter ? true : false"
              [filter]="true"
              filterPlaceholder="Search..."
            >
            </p-dropdown> -->
            <p-multiSelect
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [options]="field.options"
              [optionValue]="field.value"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [optionLabel]="field.label"
              appendTo="body"
              [showClear]="true"
              filterPlaceholder="Search..."
              [filter]="true"
            >
            </p-multiSelect>
          </span>
          <span *ngIf="field && field.type == 'timePeriod' && !field.disabled">
            <p-dropdown
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [options]="field.options"
              [optionValue]="field.value"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [optionLabel]="field.label"
              appendTo="body"
              [dropdownIcon]="'fa fa-caret-down'"
              [autoDisplayFirst]="false"
              [filter]="field.showFilter ? true : false"
              (onChange)="onTimePeriodChange($event, field, i)"
              [disabled]="field.disabled"
            >
            </p-dropdown>
          </span>
          <span *ngIf="field && field.type == 'multiselect'">
            <p-multiSelect
              [placeholder]="'Select ' + field.title"
              styleClass="text-left"
              [style]="{ width: field.fieldWidth ? field.fieldWidth : '100%' }"
              [(ngModel)]="reportData[field.field + '-' + field.filterType]"
              [dropdownIcon]="'fa fa-caret-down'"
              [options]="field.options"
              appendTo="body"
              [optionValue]="field.value"
              [optionLabel]="field.label"
            ></p-multiSelect>
          </span>
          <span *ngIf="field && field.type == 'page'">
            <div class="d-flex">
              <div class="flex-grow-1 right-border-rad">
                <input
                  pInputText
                  [class.disable-field]="true"
                  [placeholder]="'Select ' + field.title"
                  autocomplete="off"
                  [value]="
                    getLabelsFromData(
                      field,
                      reportData[field.field + '-' + field.filterType]
                    )
                  "
                  [style]="{
                    width: field.fieldWidth ? field.fieldWidth : '100%'
                  }"
                />
              </div>
              <div class="create d-flex left-border-rad">
                <button pButton pRipple class="btn btn-primary">Change</button>
              </div>
            </div>
          </span>
        </div>
      </ng-container>
    </div>
    <div class="mt-3 text-center">
      <div class="d-md-flex justify-content-center">
        <div class="mt-2">
          <button
            pButton
            pRipple
            class="p-button-primary me-2"
            (click)="generateReport(selectedReportConfig.reportType)"
          >
            Generate Report
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
