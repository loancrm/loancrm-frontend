<div>
  <div class="bread-crumb">
    <p-breadcrumb [model]="breadCrumbItems"></p-breadcrumb>
  </div>
  <div class="p-1 m-2">
    <div class="d-flex justify-content-between">
      <div
        class="d-flex align-items-center justify-content-center pointer-cursor"
        (click)="goBack()"
        style="height: 36px; width: 98px; gap: 8px"
      >
        <span class="me-2 d-flex align-items-center">
          <img src="../../../assets/images/icons/Vector.png" alt="Back" />
        </span>
        <b>
          <span class="back-btn-text"> Leads </span>
        </b>
      </div>
      <div>
        <ng-container>
          <p-dropdown
            [options]="loanTypes"
            placeholder="Add Lead"
            [(ngModel)]="selectedLoanType"
            optionLabel="displayName"
            optionValue="name"
            (onChange)="onLoanTypeSelect($event)"
            [showClear]="true"
            appendTo="body"
            styleClass="custom-dropdown"
          ></p-dropdown>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="file-upload-steps text-capitalize m-2">
    <p-tabMenu
      [model]="items"
      class="tabdesign"
      [activeItem]="activeItem"
      (activeItemChange)="onActiveItemChange($event)"
    ></p-tabMenu>
    <div *ngIf="activeItem && activeItem.name">
      <div *ngIf="activeItem.name == 'businessLoan'">
        <div class="text-capitalize">
          <p-table
            #leadsTable
            [value]="leads"
            [sortOrder]="-1"
            [lazy]="true"
            selectionMode="single"
            (onLazyLoad)="loadLeads($event)"
            dataKey="id"
            (onRowSelect)="viewLead($event)"
            [showCurrentPageReport]="true"
            [rowsPerPageOptions]="[10, 25, 50]"
            [paginator]="true"
            [rows]="10"
            class="p-datatable-striped"
            [totalRecords]="totalLeadsCount"
            [loading]="apiLoading"
            responsiveLayout="scroll"
            scrollHeight="flex"
            [globalFilterFields]="[
              'referenceNo',
              'customer.firstName',
              'partner.partnerName',
              'status',
              'businessName',
              'primaryPhone'
            ]"
            styleClass="p-datatable-customers "
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} leads"
          >
            <ng-template pTemplate="caption" style="background-color: #f7f7f7">
              <!-------Adding one searchbar in business name and phone number-->
              <div class="row">
                <div class="col-md-3 mt-2 no-padding-small">
                  <div class="p-inputgroup">
                    <input
                      type="text"
                      class="inputsearch"
                      pInputText
                      placeholder="Search Lead With Business Name"
                      [(ngModel)]="businessNameToSearch"
                      (ngModelChange)="
                        inputValueChangeEvent('loanId', businessNameToSearch)
                      "
                      (keyup.enter)="filterWithBusinessName()"
                    />
                    <!-- <button
                      type="button"
                      pButton
                      icon="pi pi-search"
                      class="p-button-primary"
                      [disabled]="!businessNameToSearch"
                      (click)="filterWithBusinessName()"
                    ></button> -->
                    <!--currently working button-->
                    <!-- <button
                      type="button"
                      pButton
                      class="p-button-primary"
                      [disabled]="!businessNameToSearch"
                      (click)="filterWithBusinessName()"
                    >
                      <img
                        src="assets/images/icons/search.svg"
                        alt="Search"
                        width="16"
                        height="16"
                        style="vertical-align: middle"
                      />
                    </button> -->

                    <span
                      class="input-group-text p-button-primaryimg"
                      (click)="filterWithBusinessName()"
                    >
                      <img
                        src="../../../assets/images/icons/search.svg"
                        alt="Search"
                        style="width: 14px; height: 14px; cursor: pointer"
                      />
                    </span>
                  </div>
                </div>
                <div
                  class="col-md-3 mt-2 no-padding-small"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType == '3'
                  "
                ></div>
                <div class="col-md-3 mt-2 no-padding-small">
                  <div
                    class="p-inputgroup position-relative"
                    *ngIf="
                      userDetails &&
                      userDetails.userType &&
                      userDetails.userType != '3'
                    "
                  >
                    <br class="d-lg-none d-md-none" />
                    <p-dropdown
                      styleClass="text-left custom-dropdowns"
                      [style]="{ width: '100%' }"
                      [options]="leadUsers"
                      (onChange)="statusChangeforSourcedBy($event)"
                      [dropdownIcon]="'pi pi-chevron-down'"
                      [(ngModel)]="selectedSourcedByStatus"
                      optionLabel="name"
                      dataKey="name"
                      appendTo="body"
                      [filter]="true"
                      filterPlaceholder="Search..."
                    >
                    </p-dropdown>
                    <!-- Custom Icon -->
                    <!-- <img
                          src="../../../../assets/images/icons/Vector.svg"
                          class="custom-dropdowns-icon"
                          alt="dropdown icon"
                        /> -->
                  </div>
                </div>
                <div class="col-md-3 mt-2 no-padding-small text-right">
                  <div class="d-flex">
                    <!-- <div class="flex-grow-1 me-2">
                      <p-dropdown
                        styleClass="text-left custom-dropdowns"
                        [style]="{ width: '100%' }"
                        [options]="leadStatus"
                        (onChange)="statusChange($event)"
                        [dropdownIcon]="'pi pi-chevron-down'"
                        [(ngModel)]="selectedLeadStatus"
                        optionLabel="displayName"
                        dataKey="name"
                        appendTo="body"
                      >
                      </p-dropdown>
                    </div> -->
                    <div
                      class="flex-grow-1 me-2 position-relative custom-dropdown-wrapper"
                    >
                      <p-dropdown
                        styleClass="text-left custom-dropdowns"
                        [style]="{ width: '100%' }"
                        [options]="leadStatus"
                        (onChange)="statusChange($event)"
                        [dropdownIcon]="'pi pi-chevron-down'"
                        [(ngModel)]="selectedLeadStatus"
                        optionLabel="displayName"
                        dataKey="name"
                        appendTo="body"
                      >
                      </p-dropdown>

                      <!-- Custom Icon -->
                      <!-- <img
                          src="../../../../assets/images/icons/Vector.svg"
                          class="custom-dropdown-icon"
                          alt="dropdown icon"
                        /> -->
                    </div>

                    <div class="d-flex align-items-center pointer-cursor">
                      <app-filter
                        [position]="'right'"
                        [iconColor]="'#ffffff'"
                        [iconSize]="'28px!important'"
                        (filterEvent)="applyConfigFilters($event, '')"
                        [filterConfig]="filterConfig"
                        [showFilterIndication]="appliedFilter"
                        pTooltip="Filter"
                        tooltipPosition="top"
                      >
                      </app-filter>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
              <tr>
                <th class="text-nowrap">Lead Id</th>
                <th class="text-nowrap">Business Name</th>
                <th class="text-nowrap">Business Entity</th>
                <th class="text-nowrap">Contact Person</th>
                <th class="text-nowrap">Primary Phone</th>
                <th>City</th>
                <th
                  class="text-nowrap"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  Sourced By
                </th>
                <th class="text-nowrap">Created Date</th>
                <th>Status</th>
                <th class="text-nowrap">Quick Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-lead>
              <tr [pSelectableRow]="lead">
                <td class="leadid">
                  <span class="table-column-data singleline">{{
                    lead.customId || "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data singleline">{{
                    lead.businessName
                      ? (lead.businessName | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.businessEntity
                      ? getEntityName(lead.businessEntity)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data singleline">{{
                    lead.contactPerson
                      ? (lead.contactPerson | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.primaryPhone ? lead.primaryPhone : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data singleline">{{
                    lead.city ? (lead.city | capitalizeFirst) : "-"
                  }}</span>
                </td>
                <td
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  <span class="table-column-data singleline">{{
                    lead.sourcedBy
                      ? (getSourceName(lead.sourcedBy) | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.createdOn
                      ? (lead.createdOn | date : "mediumDate")
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span
                    class="d-inline-flex align-items-center justify-content-start gap-2 text-nowrap"
                    [ngStyle]="{
                      backgroundColor: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).backgroundColor,
                      color: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).textColor,
                      height: '22px',
                      width: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).width,
                      borderRadius: '16px',
                      fontSize: '12px',
                      fontWeight: 500,
                      paddingLeft: '8px'
                    }"
                  >
                    <!-- Dot -->
                    <span
                      class="rounded-circle"
                      [ngStyle]="{
                        backgroundColor: getStatusColor(
                          getStatusName(lead.leadInternalStatus)
                        ).dotColor,
                        width: '8px',
                        height: '8px',
                        display: 'inline-block'
                      }"
                    ></span>

                    <!-- Status Text -->
                    {{ getStatusName(lead.leadInternalStatus) }}
                  </span>
                </td>

                <td>
                  <div class="text-center" style="text-align: left">
                    <div class="d-flex tableimage">
                      <!-- <button
                        pButton
                        pRipple
                        type="button"
                        class="p-button-primary me-2 custom-btn"
                        (click)="viewLead(lead)"
                        pTooltip="View Lead"
                        icon="fas fa-eye"
                        tooltipPosition="top"
                      ></button> -->
                      <!-- <img
                        src="../../../assets/images/icons/eye.svg"
                        width="24px"
                        height="24px"
                        class="me-2"
                        pTooltip="View Lead"
                        tooltipPosition="top"
                        (click)="viewLead(lead);$event.stopPropagation()"
                      /> -->
                      <img
                        alt="View Lead"
                        src="../../../assets/images/icons/edit.svg"
                        width="24px"
                        height="24px"
                        class="me-2"
                        (click)="updateLead(lead.id); $event.stopPropagation()"
                        pTooltip="Update Lead"
                        tooltipPosition="top"
                      />
                      <!-- <p-menu
                        appendTo="body"
                        #menu
                        [model]="actionItems(lead)"
                        [popup]="true"
                      ></p-menu>
                      <img
                        alt="Actions"
                        src="../../../assets/images/icons/menu.svg"
                        width="24px"
                        height="24px"
                        pTooltip="Actions"
                        tooltipPosition="top"
                        (click)="menu.toggle($event); $event.stopPropagation()"
                      /> -->
                      <!-- <button
                        pButton
                        pRipple
                        type="button"
                        class="p-button-info me-2 custom-btn"
                        (click)="updateLead(lead.id)"
                        pTooltip="Update Lead"
                        icon="fas fa-pen-to-square"
                        tooltipPosition="top"
                      ></button>

                      <button
                        pButton
                        type="button"
                        class="custom-btn"
                        (click)="menu.toggle($event)"
                        icon="fas fa-bars"
                        pTooltip="Actions"
                        tooltipPosition="top"
                      ></button> -->
                    
                   
                    <div>
                        <div *ngIf="lead.leadInternalStatus === 1">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="sendLeadToArchive(lead)" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/Archive.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To Archive</span>
                        </button>
                        <button mat-menu-item (click)="sendLeadToFollowUps(lead)" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/icons/Follow_Ups.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send to Follow Ups</span>
                        </button>
                        <button mat-menu-item (click)="sendLeadToFiles(lead)" class="matmenuimg" *ngIf="userDetails.userType !== '3'">
                          <img
                            alt="Actions"
                            src="assets/images/icons/sendtofiles.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To Files</span>
                        </button>
                      </mat-menu>
                      </div>
                      <div *ngIf="lead.leadInternalStatus === 2">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="revertLeadToNew(lead)" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/icons/leads.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send to New Lead</span>
                        </button>
                      </mat-menu>
                      </div>
                      <div *ngIf="lead.leadInternalStatus === 16">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="sendToLead(lead)" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/icons/leads.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To New Lead</span>
                        </button>
                        <button mat-menu-item (click)="sendLeadToFiles(lead)" class="matmenuimg" *ngIf="userDetails.userType !== '3'">
                          <img
                            alt="Actions"
                            src="assets/images/icons/sendtofiles.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send to Files</span>
                        </button>
                      </mat-menu>
                      </div>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr class="text-center">
                <td colspan="10" class="text-center fw-bold">
                  <!-- <img
                    alt="No Data"
                    src="../../../assets/images/menu/no-data.gif"
                    width="200"
                    height="200"
                  /> -->
                  <p style="color: #535ab4; font-weight: 400; font-size: 18px">
                    No Leads Found
                  </p>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
      <div *ngIf="activeItem.name == 'personalLoan'">
        <div class="text-capitalize">
          <p-table
            #personalleadsTable
            [value]="loanLeads"
            [sortOrder]="-1"
            [lazy]="true"
            selectionMode="single"
            (onLazyLoad)="loadLeadsforPersonal($event)"
            dataKey="id"
            (onRowSelect)="viewLead($event)"
            [showCurrentPageReport]="true"
            [rowsPerPageOptions]="[10, 25, 50]"
            [paginator]="true"
            [rows]="10"
            class="p-datatable-striped"
            [totalRecords]="personalloanLeadsCount"
            [loading]="loadleadsloading"
            responsiveLayout="scroll"
            scrollHeight="flex"
            [globalFilterFields]="[
              'referenceNo',
              'customer.firstName',
              'partner.partnerName',
              'status'
            ]"
            styleClass="p-datatable-customers "
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} leads"
          >
            <ng-template pTemplate="caption">
              <div class="row">
                <div class="col-md-3 mt-2 no-padding-small">
                  <div class="p-inputgroup">
                    <input
                      type="text"
                      pInputText
                      placeholder="Search Lead with Person Name"
                      [(ngModel)]="businessNameToSearchForPersonal"
                      (ngModelChange)="
                        inputValueChangeEventForPersonal(
                          'loanId',
                          businessNameToSearchForPersonal
                        )
                      "
                      (keyup.enter)="filterWithBusinessNameForPersonal()"
                    />
                    <!-- <button
                      type="button"
                      pButton
                      icon="pi pi-search"
                      class="p-button-primary"
                      [disabled]="!businessNameToSearchForPersonal"
                      (click)="filterWithBusinessNameForPersonal()"
                    ></button> -->
                    <!-- <button
                      type="button"
                      pButton
                      class="p-button-primary"
                      [disabled]="!businessNameToSearchForPersonal"
                      (click)="filterWithBusinessNameForPersonal()"
                    >
                      <img
                        src="assets/images/icons/search.svg"
                        alt="Search"
                        width="16"
                        height="16"
                        style="vertical-align: middle"
                      />
                    </button> -->
                    <span
                      class="input-group-text p-button-primaryimg"
                      (click)="filterWithBusinessNameForPersonal()"
                    >
                      <img
                        src="../../../assets/images/icons/search.svg"
                        alt="Search"
                        style="width: 14px; height: 14px; cursor: pointer"
                      />
                    </span>
                  </div>
                </div>
                <div
                  class="col-md-3 mt-2 no-padding-small"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType == '3'
                  "
                ></div>
                <div class="col-md-3 mt-2 no-padding-small">
                  <div
                    class="p-inputgroup"
                    *ngIf="
                      userDetails &&
                      userDetails.userType &&
                      userDetails.userType != '3'
                    "
                  >
                    <br class="d-lg-none d-md-none" />
                    <p-dropdown
                      styleClass="text-left"
                      [style]="{ width: '100%' }"
                      [options]="leadUsers"
                      (onChange)="statusChangeForPersonal($event)"
                      [dropdownIcon]="'pi pi-chevron-down'"
                      [(ngModel)]="SourcedByForPersonal"
                      optionLabel="name"
                      dataKey="name"
                      appendTo="body"
                      [filter]="true"
                      filterPlaceholder="Search..."
                    >
                    </p-dropdown>
                  </div>
                </div>
                <div class="col-md-3 mt-2 no-padding-small text-right">
                  <div class="d-flex">
                    <div class="flex-grow-1 me-2">
                      <p-dropdown
                        styleClass="text-left"
                        [style]="{ width: '100%' }"
                        [options]="leadStatus"
                        (onChange)="statusChangeForPersonal($event)"
                        [dropdownIcon]="'pi pi-chevron-down'"
                        [(ngModel)]="selectedPersonalLeadStatus"
                        optionLabel="displayName"
                        dataKey="name"
                        appendTo="body"
                      >
                      </p-dropdown>
                    </div>
                    <div class="d-flex align-items-center pointer-cursor">
                      <app-filter
                        [position]="'right'"
                        [iconColor]="'#33009C'"
                        [iconSize]="'28px!important'"
                        (filterEvent)="applyConfigFilters($event, 'Personal')"
                        [filterConfig]="personalfilterConfig"
                        [showFilterIndication]="appliedFilterPersonal"
                        pTooltip="Filter"
                        tooltipPosition="top"
                      >
                      </app-filter>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
              <tr>
                <th class="text-nowrap">Lead Id</th>
                <th class="text-nowrap">Applicant Name</th>
                <th>Designation</th>
                <th class="text-nowrap">Primary Phone</th>
                <th>Salary</th>
                <th>Job Experience</th>
                <th
                  class="text-nowrap"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  Sourced By
                </th>
                <th class="text-nowrap">Created Date</th>
                <th>Status</th>
                <th class="text-nowrap">Quick Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-lead>
              <tr [pSelectableRow]="lead">
                <td class="leadid">
                  <span class="table-column-data singleline">{{
                    lead.customId || "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data singleline">{{
                    lead.contactPerson
                      ? (lead.contactPerson | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data singleline">{{
                    lead.designation
                      ? (lead.designation | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.primaryPhone ? lead.primaryPhone : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.salary ? lead.salary : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.jobExperience ? lead.jobExperience : "-"
                  }}</span>
                </td>
                <td
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  <span class="table-column-data singleline">{{
                    lead.sourcedByName
                      ? (lead.sourcedByName | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.createdOn
                      ? (lead.createdOn | date : "mediumDate")
                      : "-"
                  }}</span>
                </td>
                <td>
                  <!-- <span
                    class="table-column-data fw-bold statusdata"
                    *ngIf="lead.leadInternalStatus"
                    [ngStyle]="{
                      color: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).textColor,

                    }"
                  >
                    {{ getStatusName(lead.leadInternalStatus) }}
                  </span> -->
                  <span
                    class="d-inline-flex align-items-center justify-content-start gap-2"
                    [ngStyle]="{
                      backgroundColor: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).backgroundColor,
                      color: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).textColor,
                      height: '22px',
                      width: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).width,
                      borderRadius: '16px',
                      fontSize: '12px',
                      fontWeight: 500,
                      paddingLeft: '8px'
                    }"
                  >
                    <!-- Dot -->
                    <span
                      class="rounded-circle"
                      [ngStyle]="{
                        backgroundColor: getStatusColor(
                          getStatusName(lead.leadInternalStatus)
                        ).dotColor,
                        width: '8px',
                        height: '8px',
                        display: 'inline-block'
                      }"
                    ></span>

                    <!-- Status Text -->
                    {{ getStatusName(lead.leadInternalStatus) }}
                  </span>
                </td>
                <td>
                  <div class="text-center">
                    <div class="d-flex tableimage">
                      <!-- <button
                        pButton
                        pRipple
                        type="button"
                        class="p-button-primary me-2 custom-btn"
                        (click)="viewLead(lead)"
                        pTooltip="View Lead"
                        icon="fas fa-eye"
                        tooltipPosition="top"
                      ></button> -->
                      <!-- <img
                        src="../../../assets/images/icons/eye.svg"
                        width="24px"
                        height="24px"
                        class="me-2"
                        (click)="viewLead(lead)"
                        pTooltip="View Lead"
                        tooltipPosition="top"
                      /> -->
                      <!-- <button
                        pButton
                        pRipple
                        type="button"
                        class="p-button-info me-2 custom-btn"
                        (click)="updateLoanLead(lead.leadId)"
                        pTooltip="Update Lead"
                        icon="fas fa-pen-to-square"
                        tooltipPosition="top"
                      ></button> -->
                      <img
                        alt="Update Lead"
                        src="../../../assets/images/icons/edit.svg"
                        width="24px"
                        height="24px"
                        class="me-2"
                        (click)="updateLoanLead(lead.leadId)"
                        pTooltip="Update Lead"
                        tooltipPosition="top"
                      />
                      <!-- <p-menu
                        appendTo="body"
                        #menu
                        [model]="actionItemsForLead(lead, 'personal')"
                        [popup]="true"
                      ></p-menu> -->
                      <!-- <button
                        pButton
                        type="button"
                        class="custom-btn"
                        (click)="menu.toggle($event)"
                        icon="fas fa-bars"
                        pTooltip="Actions"
                        tooltipPosition="top"
                      ></button> -->
                      <!-- <img
                        alt="Actions"
                        src="../../../assets/images/icons/menu.svg"
                        width="24px"
                        height="24px"
                        pTooltip="Actions"
                        tooltipPosition="top"
                        (click)="menu.toggle($event); $event.stopPropagation()"
                      /> -->
                    
                      <div>
                        <div *ngIf="lead.leadInternalStatus === 1">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'personal')" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/Archive.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To Archive</span>
                        </button>
                        <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'personal')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                          <img
                            alt="Actions"
                            src="assets/images/icons/sendtofiles.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To Files</span>
                        </button>
                      </mat-menu>

                      </div>
                      <div *ngIf="lead.leadInternalStatus === 2">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'personal')" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/icons/leads.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send to New Lead</span>
                        </button>
                      </mat-menu>
                      </div>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr class="text-center">
                <td colspan="10" class="text-center fw-bold">
                  <!-- <img
                    alt="No Data"
                    src="../../../assets/images/menu/no-data.gif"
                    width="200"
                    height="200"
                  /> -->
                  <p style="color: #535ab4; font-weight: 400; font-size: 18px">
                    No Leads Found
                  </p>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
      <div *ngIf="activeItem.name == 'homeLoan'">
        <p-tabMenu
          [model]="employmentStatus"
          class="tabdesign"
          [activeItem]="activeEmploymentStatus"
          (activeItemChange)="onActiveEmploymentStatusChange($event)"
        ></p-tabMenu>
        <ng-container
          *ngIf="activeEmploymentStatus && activeEmploymentStatus.name"
        >
          <ng-container
            *ngIf="
              activeEmploymentStatus.name == 'employed' ||
              activeEmploymentStatus.name == 'self-employed'
            "
          >
            <div class="text-capitalize">
              <p-table
                #HomeleadsTable
                [value]="loanLeads"
                [sortOrder]="-1"
                (onRowSelect)="viewLead($event)"
                [lazy]="true"
                selectionMode="single"
                (onLazyLoad)="
                  activeEmploymentStatus.name == 'employed'
                    ? loadLeadsforHome($event)
                    : loadLeadsforHomeself($event)
                "
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                class="p-datatable-striped"
                [totalRecords]="
                  activeEmploymentStatus.name == 'employed'
                    ? homeloanLeadsCount
                    : homeloanselfLeadsCount
                "
                [loading]="loadleadsloading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} leads"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          [placeholder]="
                            activeEmploymentStatus.name === 'employed'
                              ? 'Search Lead with Person Name'
                              : 'Search Lead with Business Name'
                          "
                          [(ngModel)]="searchInputValue"
                          (ngModelChange)="handleInputChange($event)"
                          (keyup.enter)="filterBasedOnEmploymentStatus()"
                        />
                        <!-- <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        ></button> -->
                        <!-- <button
                          type="button"
                          pButton
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="assets/images/icons/search.svg"
                            alt="Search"
                            width="16"
                            height="16"
                            style="vertical-align: middle"
                          />
                        </button> -->
                        <span
                          class="input-group-text p-button-primary"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="../../../assets/images/icons/search.svg"
                            alt="Search"
                            style="width: 14px; height: 14px; cursor: pointer"
                          />
                        </span>
                      </div>
                    </div>
                    <div
                      class="col-md-3 mt-2 no-padding-small"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType == '3'
                      "
                    ></div>
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div
                        class="p-inputgroup"
                        *ngIf="
                          userDetails &&
                          userDetails.userType &&
                          userDetails.userType != '3'
                        "
                      >
                        <br class="d-lg-none d-md-none" />
                        <p-dropdown
                          styleClass="text-left"
                          [style]="{ width: '100%' }"
                          [options]="leadUsers"
                          (onChange)="
                            activeEmploymentStatus.name === 'employed'
                              ? statusChangeForHome($event)
                              : statusChangeForHomeSelf($event)
                          "
                          [dropdownIcon]="'pi pi-chevron-down'"
                          [(ngModel)]="SourcedByForHome"
                          optionLabel="name"
                          dataKey="name"
                          [filter]="true"
                          appendTo="body"
                          filterPlaceholder="Search..."
                        >
                        </p-dropdown>
                      </div>
                    </div>
                    <div class="col-md-3 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <p-dropdown
                            styleClass="text-left"
                            [style]="{ width: '100%' }"
                            [options]="leadStatus"
                            (onChange)="
                              activeEmploymentStatus.name === 'employed'
                                ? statusChangeForHome($event)
                                : statusChangeForHomeSelf($event)
                            "
                            [dropdownIcon]="'pi pi-chevron-down'"
                            [(ngModel)]="selectedHomeLeadStatus"
                            optionLabel="displayName"
                            dataKey="name"
                            appendTo="body"
                          >
                          </p-dropdown>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="
                              activeEmploymentStatus.name === 'employed'
                                ? applyConfigFilters($event, 'Home')
                                : applyConfigFilters($event, 'Homeself')
                            "
                            [filterConfig]="
                              activeEmploymentStatus.name === 'employed'
                                ? HomefilterConfig
                                : HomeSelffilterConfig
                            "
                            [showFilterIndication]="
                              activeEmploymentStatus.name === 'employed'
                                ? appliedFilterHome
                                : appliedFilterHomeself
                            "
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th class="text-nowrap">Lead Id</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Applicant Name
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Name
                    </th>
                    <th *ngIf="activeEmploymentStatus.name === 'employed'">
                      Designation
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Entity
                    </th>
                    <th *ngIf="activeEmploymentStatus.name === 'employed'">
                      Salary
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Contact Person
                    </th>
                    <th class="text-nowrap">Primary Phone</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Job Experience
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Turnover
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      Sourced By
                    </th>
                    <th class="text-nowrap">Created Date</th>
                    <th>Status</th>
                    <th class="text-nowrap">Quick Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td class="leadid">
                      <span class="table-column-data singleline">{{
                        lead.customId || "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data singleline">{{
                        lead.contactPerson
                          ? (lead.contactPerson | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data singleline">{{
                        lead.businessName
                          ? (lead.businessName | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data singleline">{{
                        lead.designation
                          ? (lead.designation | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data">{{
                        lead.businessEntity
                          ? getEntityName(lead.businessEntity)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data">{{
                        lead.salary ? lead.salary : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data singleline">{{
                        lead.contactPerson
                          ? (lead.contactPerson | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data">{{
                        lead.primaryPhone ? lead.primaryPhone : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data">{{
                        lead.jobExperience ? lead.jobExperience : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data">{{
                        lead.businessTurnover ? lead.businessTurnover : "-"
                      }}</span>
                    </td>
                    <td
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      <span class="table-column-data singleline">{{
                        lead.sourcedByName
                          ? (lead.sourcedByName | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data">{{
                        lead.createdOn
                          ? (lead.createdOn | date : "mediumDate")
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <!-- <span
                        class="table-column-data fw-bold statusdata"
                        [ngStyle]="{
                          color: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).textColor,

                        }"
                      >
                        {{ getStatusName(lead.leadInternalStatus) }}
                      </span> -->
                      <span
                        class="d-inline-flex align-items-center justify-content-start gap-2"
                        [ngStyle]="{
                          backgroundColor: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).backgroundColor,
                          color: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).textColor,
                          height: '22px',
                          width: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).width,
                          borderRadius: '16px',
                          fontSize: '12px',
                          fontWeight: 500,
                          paddingLeft: '8px'
                        }"
                      >
                        <!-- Dot -->
                        <span
                          class="rounded-circle"
                          [ngStyle]="{
                            backgroundColor: getStatusColor(
                              getStatusName(lead.leadInternalStatus)
                            ).dotColor,
                            width: '8px',
                            height: '8px',
                            display: 'inline-block'
                          }"
                        ></span>

                        <!-- Status Text -->
                        {{ getStatusName(lead.leadInternalStatus) }}
                      </span>
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex tableimage">
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-primary me-2 custom-btn"
                            (click)="viewLead(lead)"
                            pTooltip="View Lead"
                            icon="fas fa-eye"
                            tooltipPosition="top"
                          ></button> -->
                          <!-- <img
                            src="../../../assets/images/icons/eye.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            tooltipPosition="top"
                            (click)="viewLead(lead)"
                            pTooltip="View Lead"
                          /> -->
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-info me-2 custom-btn"
                            (click)="updateLoanLead(lead.leadId)"
                            pTooltip="Update Lead"
                            icon="fas fa-pen-to-square"
                            tooltipPosition="top"
                          ></button> -->
                          <img
                            alt="Update Lead"
                            src="../../../assets/images/icons/edit.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            (click)="updateLoanLead(lead.leadId)"
                            pTooltip="Update Lead"
                            tooltipPosition="top"
                          />
                          <!-- <p-menu
                            appendTo="body"
                            #menuhome
                            [model]="getHomeActionItems(lead)"
                            [popup]="true"
                          ></p-menu> -->

                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menuhome.toggle($event)"
                            icon="fas fa-bars"
                            pTooltip="Actions"
                            tooltipPosition="top"
                          ></button> -->
                          <!-- <img
                            alt="Actions"
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="
                              menuhome.toggle($event); $event.stopPropagation()
                            "
                          /> -->

                          <div *ngIf="activeEmploymentStatus.name === 'employed'">
                            <div>
                            <div *ngIf="lead.leadInternalStatus === 1">
                            <button
                            [matMenuTriggerFor]="menu"
                            aria-label="Actions"
                            style="all: unset; cursor: pointer"
                          >
                            <img
                              alt="Actions"
                              src="assets/images/icons/menu.svg"
                              width="24"
                              height="24"
                            />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'home')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/Archive.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Archive</span>
                              </button>
                              <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'home')" class="matmenuimg" *ngIf="userDetails.userType !== '3'">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/sendtofiles.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Files</span>
                              </button>
                            </mat-menu>
                            </div>
                            <div *ngIf="lead.leadInternalStatus === 2">
                              <button
                              [matMenuTriggerFor]="menu"
                              aria-label="Actions"
                              style="all: unset; cursor: pointer"
                            >
                              <img
                                alt="Actions"
                                src="assets/images/icons/menu.svg"
                                width="24"
                                height="24"
                              />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'home')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/leads.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send to New Lead</span>
                              </button>
                            </mat-menu>
                            </div>
                          </div>
                          </div>
                          <div *ngIf="activeEmploymentStatus.name === 'self-employed'">
                            <div *ngIf="userDetails.userType !==3">
                            <div *ngIf="lead.leadInternalStatus === 1">
                            <button
                            [matMenuTriggerFor]="menu"
                            aria-label="Actions"
                            style="all: unset; cursor: pointer"
                          >
                            <img
                              alt="Actions"
                              src="assets/images/icons/menu.svg"
                              width="24"
                              height="24"
                            />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'homeself')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/Archive.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Archive</span>
                              </button>
                              <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'homeself')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/sendtofiles.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Files</span>
                              </button>
                            </mat-menu>
                            </div>
                            <div *ngIf="lead.leadInternalStatus === 2">
                              <button
                              [matMenuTriggerFor]="menu"
                              aria-label="Actions"
                              style="all: unset; cursor: pointer"
                            >
                              <img
                                alt="Actions"
                                src="assets/images/icons/menu.svg"
                                width="24"
                                height="24"
                              />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'homeself')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/leads.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send to New Lead</span>
                              </button>
                            </mat-menu>
                            </div>
                          </div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <!-- <img
                        alt="No Data"
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      /> -->
                      <p
                        style="
                          color: #535ab4;
                          font-weight: 400;
                          font-size: 18px;
                        "
                      >
                        No Leads Found
                      </p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </ng-container>
        </ng-container>
      </div>
      <div *ngIf="activeItem.name == 'lap'">
        <p-tabMenu
          [model]="employmentStatus"
          class="tabdesign"
          [activeItem]="activeEmploymentStatus"
          (activeItemChange)="onActiveEmploymentStatusChange($event)"
        ></p-tabMenu>
        <ng-container
          *ngIf="activeEmploymentStatus && activeEmploymentStatus.name"
        >
          <ng-container
            *ngIf="
              activeEmploymentStatus.name == 'employed' ||
              activeEmploymentStatus.name == 'self-employed'
            "
          >
            <div class="text-capitalize">
              <p-table
                #LapleadsTable
                [value]="loanLeads"
                [sortOrder]="-1"
                [lazy]="true"
                selectionMode="single"
                (onRowSelect)="viewLead($event)"
                (onLazyLoad)="
                  activeEmploymentStatus.name == 'employed'
                    ? loadLeadsforlap($event)
                    : loadLeadsforlapself($event)
                "
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                class="p-datatable-striped"
                [totalRecords]="
                  activeEmploymentStatus.name == 'employed'
                    ? lapLeadsCount
                    : lapselfLeadsCount
                "
                [loading]="loadleadsloading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} leads"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          [placeholder]="
                            activeEmploymentStatus.name === 'employed'
                              ? 'Search Lead with Person Name'
                              : 'Search Lead with Business Name'
                          "
                          [(ngModel)]="searchInputValue"
                          (ngModelChange)="handleInputChange($event)"
                          (keyup.enter)="filterBasedOnEmploymentStatus()"
                        />
                        <!-- <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        ></button> -->
                        <!-- <button
                          type="button"
                          pButton
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="assets/images/icons/search.svg"
                            alt="Search"
                            width="16"
                            height="16"
                            style="vertical-align: middle"
                          />
                        </button> -->
                        <span
                            class="input-group-text p-button-primary"
                            (click)="filterBasedOnEmploymentStatus()"
                          >
                            <img
                              src="../../../assets/images/icons/search.svg"
                              alt="Search"
                              style="width: 14px; height: 14px; cursor: pointer"
                            />
                          </span>
                      </div>
                    </div>
                    <div
                      class="col-md-3 mt-2 no-padding-small"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType == '3'
                      "
                    ></div>
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div
                        class="p-inputgroup"
                        *ngIf="
                          userDetails &&
                          userDetails.userType &&
                          userDetails.userType != '3'
                        "
                      >
                        <br class="d-lg-none d-md-none" />
                        <p-dropdown
                          styleClass="text-left"
                          [style]="{ width: '100%' }"
                          [options]="leadUsers"
                          (onChange)="
                            activeEmploymentStatus.name === 'employed'
                              ? statusChangeForLap($event)
                              : statusChangeForLapSelf($event)
                          "
                          [dropdownIcon]="'pi pi-chevron-down'"
                          [(ngModel)]="SourcedByForLap"
                          optionLabel="name"
                          dataKey="name"
                          appendTo="body"
                          [filter]="true"
                          filterPlaceholder="Search..."
                        >
                        </p-dropdown>
                      </div>
                    </div>
                    <div class="col-md-3 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <p-dropdown
                            styleClass="text-left"
                            [style]="{ width: '100%' }"
                            [options]="leadStatus"
                            (onChange)="
                              activeEmploymentStatus.name === 'employed'
                                ? statusChangeForLap($event)
                                : statusChangeForLapSelf($event)
                            "
                            [dropdownIcon]="'pi pi-chevron-down'"
                            [(ngModel)]="selectedLapLeadStatus"
                            optionLabel="displayName"
                            dataKey="name"
                            appendTo="body"
                          >
                          </p-dropdown>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="
                              activeEmploymentStatus.name === 'employed'
                                ? applyConfigFilters($event, 'Lap')
                                : applyConfigFilters($event, 'Lapself')
                            "
                            [filterConfig]="
                              activeEmploymentStatus.name === 'employed'
                                ? HomefilterConfig
                                : HomeSelffilterConfig
                            "
                            [showFilterIndication]="
                              activeEmploymentStatus.name === 'employed'
                                ? appliedFilterLap
                                : appliedFilterLapself
                            "
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th class="text-nowrap">Lead Id</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Applicant Name
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Name
                    </th>
                    <th *ngIf="activeEmploymentStatus.name === 'employed'">
                      Designation
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Entity
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Contact Person
                    </th>
                    <th class="text-nowrap">Primary Phone</th>
                    <th *ngIf="activeEmploymentStatus.name === 'employed'">
                      Salary
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Job Experience
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      Sourced By
                    </th>
                    <th class="text-nowrap">Created Date</th>
                    <th>Status</th>
                    <th class="text-nowrap">Quick Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td class="leadid">
                      <span
                        class="table-column-data singleline"
                        *ngIf="lead.customId"
                        >{{ lead.customId }}</span
                      >
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data singleline">{{
                        lead.contactPerson
                          ? (lead.contactPerson | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data singleline">{{
                        lead.businessName
                          ? (lead.businessName | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data singleline">{{
                        lead.designation
                          ? (lead.designation | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data">{{
                        lead.businessEntity
                          ? getEntityName(lead.businessEntity)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data singleline">{{
                        lead.contactPerson
                          ? (lead.contactPerson | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data">{{
                        lead.primaryPhone ? lead.primaryPhone : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data">{{
                        lead.salary ? lead.salary : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data">{{
                        lead.jobExperience ? lead.jobExperience : "-"
                      }}</span>
                    </td>

                    <td
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      <span class="table-column-data singleline">{{
                        lead.sourcedByName
                          ? (lead.sourcedByName | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data">{{
                        lead.createdOn
                          ? (lead.createdOn | date : "mediumDate")
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <!-- <span
                        class="table-column-data fw-bold statusdata"
                        *ngIf="lead.leadInternalStatus"
                        [ngStyle]="{
                          color: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).textColor,

                        }"
                      >
                        {{ getStatusName(lead.leadInternalStatus) }}
                      </span> -->
                      <span
                        class="d-inline-flex align-items-center justify-content-start gap-2"
                        [ngStyle]="{
                          backgroundColor: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).backgroundColor,
                          color: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).textColor,
                          height: '22px',
                          width: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).width,
                          borderRadius: '16px',
                          fontSize: '12px',
                          fontWeight: 500,
                          paddingLeft: '8px'
                        }"
                      >
                        <!-- Dot -->
                        <span
                          class="rounded-circle"
                          [ngStyle]="{
                            backgroundColor: getStatusColor(
                              getStatusName(lead.leadInternalStatus)
                            ).dotColor,
                            width: '8px',
                            height: '8px',
                            display: 'inline-block'
                          }"
                        ></span>

                        <!-- Status Text -->
                        {{ getStatusName(lead.leadInternalStatus) }}
                      </span>
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex tableimage">
                          <!-- <img
                            src="../../../assets/images/icons/eye.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            (click)="viewLead(lead)"
                            pTooltip="View Lead"
                            tooltipPosition="top"
                          /> -->
                          <img
                            alt="View Lead"
                            src="../../../assets/images/icons/edit.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            (click)="updateLoanLead(lead.leadId)"
                            pTooltip="Update Lead"
                            tooltipPosition="top"
                          />
                          <!-- <p-menu
                            appendTo="body"
                            #menu
                            [model]="getLapActionItems(lead)"
                            [popup]="true"
                          ></p-menu>
                          <img
                            alt="Actions"
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            (click)="
                              menu.toggle($event); $event.stopPropagation()
                            "
                            pTooltip="Actions"
                            tooltipPosition="top"
                          /> -->
                          <div *ngIf="activeEmploymentStatus.name === 'employed'">
                            <div>
                            <div *ngIf="lead.leadInternalStatus === 1">
                            <button
                            [matMenuTriggerFor]="menu"
                            aria-label="Actions"
                            style="all: unset; cursor: pointer"
                          >
                            <img
                              alt="Actions"
                              src="assets/images/icons/menu.svg"
                              width="24"
                              height="24"
                            />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'lap')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/Archive.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Archive</span>
                              </button>
                              <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'lap')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/sendtofiles.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Files</span>
                              </button>
                            </mat-menu>
                            </div>
                            <div *ngIf="lead.leadInternalStatus === 2">
                              <button
                              [matMenuTriggerFor]="menu"
                              aria-label="Actions"
                              style="all: unset; cursor: pointer"
                            >
                              <img
                                alt="Actions"
                                src="assets/images/icons/menu.svg"
                                width="24"
                                height="24"
                              />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'lap')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/leads.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send to New Lead</span>
                              </button>
                            </mat-menu>
                            </div>
                          </div>
                          </div>
                          <div *ngIf="activeEmploymentStatus.name === 'self-employed'">
                            <div *ngIf="userDetails.userType !==3">
                            <div *ngIf="lead.leadInternalStatus === 1">
                            <button
                            [matMenuTriggerFor]="menu"
                            aria-label="Actions"
                            style="all: unset; cursor: pointer"
                          >
                            <img
                              alt="Actions"
                              src="assets/images/icons/menu.svg"
                              width="24"
                              height="24"
                            />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'lapself')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/Archive.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Archive</span>
                              </button>
                              <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'lapself')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/sendtofiles.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Files</span>
                              </button>
                            </mat-menu>
                            </div>
                            <div *ngIf="lead.leadInternalStatus === 2">
                              <button
                              [matMenuTriggerFor]="menu"
                              aria-label="Actions"
                              style="all: unset; cursor: pointer"
                            >
                              <img
                                alt="Actions"
                                src="assets/images/icons/menu.svg"
                                width="24"
                                height="24"
                              />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'lapself')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/leads.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send to New Lead</span>
                              </button>
                            </mat-menu>
                            </div>
                          </div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <!-- <img
                        alt="No Data"
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      /> -->
                      <p
                        style="
                          color: #535ab4;
                          font-weight: 400;
                          font-size: 18px;
                        "
                      >
                        No Leads Found
                      </p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </ng-container>
        </ng-container>
      </div>
      <div *ngIf="activeItem.name == 'professionalLoans'">
        <div class="text-capitalize">
          <p-table
            #professionalleadsTable
            [value]="loanLeads"
            [sortOrder]="-1"
            [lazy]="true"
            selectionMode="single"
            (onLazyLoad)="loapLeadsforprofessional($event)"
            dataKey="id"
            (onRowSelect)="viewLead($event)"
            [showCurrentPageReport]="true"
            [rowsPerPageOptions]="[10, 25, 50]"
            [paginator]="true"
            [rows]="10"
            class="p-datatable-striped"
            [totalRecords]="professionalloanLeadsCount"
            [loading]="loadleadsloading"
            responsiveLayout="scroll"
            scrollHeight="flex"
            [globalFilterFields]="[
              'referenceNo',
              'customer.firstName',
              'partner.partnerName',
              'status'
            ]"
            styleClass="p-datatable-customers "
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} leads"
          >
            <ng-template pTemplate="caption">
              <div class="row">
                <div class="col-md-3 mt-2 no-padding-small">
                  <div class="p-inputgroup">
                    <input
                      type="text"
                      pInputText
                      placeholder="Search Lead with Person Name"
                      [(ngModel)]="businessNameToSearchForProfessional"
                      (ngModelChange)="
                        inputValueChangeEventForProfessional(
                          'loanId',
                          businessNameToSearchForProfessional
                        )
                      "
                      (keyup.enter)="filterWithBusinessNameForProfessional()"
                    />
                    <!-- <button
                      type="button"
                      pButton
                      icon="pi pi-search"
                      class="p-button-primary"
                      [disabled]="!businessNameToSearchForPersonal"
                      (click)="filterWithBusinessNameForPersonal()"
                    ></button> -->
                    <!-- <button
                      type="button"
                      pButton
                      class="p-button-primary"
                      [disabled]="!businessNameToSearchForProfessional"
                      (click)="filterWithBusinessNameForProfessional()"
                    >
                      <img
                        src="assets/images/icons/search.svg"
                        alt="Search"
                        width="16"
                        height="16"
                        style="vertical-align: middle"
                      />
                    </button> -->
                    <span
                      class="input-group-text p-button-primary"
                      (click)="filterWithBusinessNameForProfessional()"
                    >
                      <img
                        src="../../../assets/images/icons/search.svg"
                        alt="Search"
                        style="width: 14px; height: 14px; cursor: pointer"
                      />
                    </span>
                  </div>
                </div>
                <div
                  class="col-md-3 mt-2 no-padding-small"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType == '3'
                  "
                ></div>
                <div class="col-md-3 mt-2 no-padding-small">
                  <div
                    class="p-inputgroup"
                    *ngIf="
                      userDetails &&
                      userDetails.userType &&
                      userDetails.userType != '3'
                    "
                  >
                    <br class="d-lg-none d-md-none" />
                    <p-dropdown
                      styleClass="text-left"
                      [style]="{ width: '100%' }"
                      [options]="leadUsers"
                      (onChange)="statusChangeForprofessional($event)"
                      [dropdownIcon]="'pi pi-chevron-down'"
                      [(ngModel)]="SourcedByForProfessional"
                      optionLabel="name"
                      dataKey="name"
                      appendTo="body"
                      [filter]="true"
                      filterPlaceholder="Search..."
                    >
                    </p-dropdown>
                  </div>
                </div>
                <div class="col-md-3 mt-2 no-padding-small text-right">
                  <div class="d-flex">
                    <div class="flex-grow-1 me-2">
                      <p-dropdown
                        styleClass="text-left"
                        [style]="{ width: '100%' }"
                        [options]="leadStatus"
                        (onChange)="statusChangeForprofessional($event)"
                        [dropdownIcon]="'pi pi-chevron-down'"
                        [(ngModel)]="selectedProfessionalLeadStatus"
                        optionLabel="displayName"
                        dataKey="name"
                        appendTo="body"
                      >
                      </p-dropdown>
                    </div>
                    <div class="d-flex align-items-center pointer-cursor">
                      <app-filter
                        [position]="'right'"
                        [iconColor]="'#33009C'"
                        [iconSize]="'28px!important'"
                        (filterEvent)="applyConfigFilters($event, 'Personal')"
                        [filterConfig]="personalfilterConfig"
                        [showFilterIndication]="appliedFilterPersonal"
                        pTooltip="Filter"
                        tooltipPosition="top"
                      >
                      </app-filter>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
              <tr>
                <th class="text-nowrap">Lead Id</th>
                <th class="text-nowrap">Applicant Name</th>
                <th>Designation Type</th>
                <th class="text-nowrap">Primary Phone</th>
                <th>Salary</th>
                <th>Employment Type</th>
                <th
                  class="text-nowrap"
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  Sourced By
                </th>
                <th class="text-nowrap">Created Date</th>
                <th>Status</th>
                <th class="text-nowrap">Quick Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-lead>
              <tr [pSelectableRow]="lead">
                <td class="leadid">
                  <span class="table-column-data singleline">{{
                    lead.customId || "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data singleline">{{
                    lead.contactPerson
                      ? (lead.contactPerson | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <!-- <td>
                  <span class="table-column-data singleline">{{
                    lead.designation
                      ? (lead.designation | capitalizeFirst)
                      : "-"
                  }}</span>
                </td> -->
                <td>
                  <span class="table-column-data singleline">
                    {{
                      lead.designation
                        ? (getDesignationType(lead.designation)
                          | capitalizeFirst)
                        : "-"
                    }}
                  </span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.primaryPhone ? lead.primaryPhone : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.salary ? lead.salary : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">
                    {{
                      lead.employmentType
                        ? (getEmploymentType(lead.employmentType)
                          | capitalizeFirst)
                        : "-"
                    }}
                  </span>
                </td>
                <td
                  *ngIf="
                    userDetails &&
                    userDetails.userType &&
                    userDetails.userType != '3'
                  "
                >
                  <span class="table-column-data singleline">{{
                    lead.sourcedByName
                      ? (lead.sourcedByName | capitalizeFirst)
                      : "-"
                  }}</span>
                </td>
                <td>
                  <span class="table-column-data">{{
                    lead.createdOn
                      ? (lead.createdOn | date : "mediumDate")
                      : "-"
                  }}</span>
                </td>
                <td>
                  <!-- <span
                    class="table-column-data fw-bold statusdata"
                    *ngIf="lead.leadInternalStatus"
                    [ngStyle]="{
                      color: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).textColor,

                    }"
                  >
                    {{ getStatusName(lead.leadInternalStatus) }}
                  </span> -->
                  <span
                    class="d-inline-flex align-items-center justify-content-start gap-2"
                    [ngStyle]="{
                      backgroundColor: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).backgroundColor,
                      color: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).textColor,
                      height: '22px',
                      width: getStatusColor(
                        getStatusName(lead.leadInternalStatus)
                      ).width,
                      borderRadius: '16px',
                      fontSize: '12px',
                      fontWeight: 500,
                      paddingLeft: '8px'
                    }"
                  >
                    <!-- Dot -->
                    <span
                      class="rounded-circle"
                      [ngStyle]="{
                        backgroundColor: getStatusColor(
                          getStatusName(lead.leadInternalStatus)
                        ).dotColor,
                        width: '8px',
                        height: '8px',
                        display: 'inline-block'
                      }"
                    ></span>

                    <!-- Status Text -->
                    {{ getStatusName(lead.leadInternalStatus) }}
                  </span>
                </td>
                <td>
                  <div class="text-center">
                    <div class="d-flex tableimage">
                      <!-- <button
                        pButton
                        pRipple
                        type="button"
                        class="p-button-primary me-2 custom-btn"
                        (click)="viewLead(lead)"
                        pTooltip="View Lead"
                        icon="fas fa-eye"
                        tooltipPosition="top"
                      ></button> -->
                      <!-- <img
                        src="../../../assets/images/icons/eye.svg"
                        width="24px"
                        height="24px"
                        class="me-2"
                        (click)="viewLead(lead)"
                        pTooltip="View Lead"
                        tooltipPosition="top"
                      /> -->
                      <!-- <button
                        pButton
                        pRipple
                        type="button"
                        class="p-button-info me-2 custom-btn"
                        (click)="updateLoanLead(lead.leadId)"
                        pTooltip="Update Lead"
                        icon="fas fa-pen-to-square"
                        tooltipPosition="top"
                      ></button> -->
                      <img
                        alt="Update Lead"
                        src="../../../assets/images/icons/edit.svg"
                        width="24px"
                        height="24px"
                        class="me-2"
                        (click)="updateLoanLead(lead.leadId)"
                        pTooltip="Update Lead"
                        tooltipPosition="top"
                      />
                      <!-- <p-menu
                        appendTo="body"
                        #menu
                        [model]="actionItemsForLead(lead, 'personal')"
                        [popup]="true"
                      ></p-menu> -->
                      <!-- <button
                        pButton
                        type="button"
                        class="custom-btn"
                        (click)="menu.toggle($event)"
                        icon="fas fa-bars"
                        pTooltip="Actions"
                        tooltipPosition="top"
                      ></button> -->
                      <!-- <img
                        alt="Actions"
                        src="../../../assets/images/icons/menu.svg"
                        width="24px"
                        height="24px"
                        pTooltip="Actions"
                        tooltipPosition="top"
                        (click)="menu.toggle($event); $event.stopPropagation()"
                      /> -->

                      <div *ngIf="userDetails.userType !==3">
                        <div *ngIf="lead.leadInternalStatus === 1">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'professional')" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/Archive.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To Archive</span>
                        </button>
                        <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'professional')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                          <img
                            alt="Actions"
                            src="assets/images/icons/sendtofiles.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send To Files</span>
                        </button>
                      </mat-menu>

                      </div>
                      <div *ngIf="lead.leadInternalStatus === 2">
                        <button
                        [matMenuTriggerFor]="menu"
                        aria-label="Actions"
                        style="all: unset; cursor: pointer"
                      >
                        <img
                          alt="Actions"
                          src="assets/images/icons/menu.svg"
                          width="24"
                          height="24"
                        />
                      </button>
                      <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'professional')" class="matmenuimg">
                          <img
                            alt="Actions"
                            src="assets/images/icons/leads.svg"
                            width="24"
                            height="24"
                            class="mr-2 image-icon"
                          />
                          <span>Send to New Lead</span>
                        </button>
                      </mat-menu>
                      </div>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr class="text-center">
                <td colspan="10" class="text-center fw-bold">
                  <!-- <img
                    alt="No Data"
                    src="../../../assets/images/menu/no-data.gif"
                    width="200"
                    height="200"
                  /> -->
                  <p style="color: #535ab4; font-weight: 400; font-size: 18px">
                    No Leads Found
                  </p>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
      <div *ngIf="activeItem.name == 'educationlLoans'">
        <app-comming-soon></app-comming-soon>
      </div>
      <div *ngIf="activeItem.name == 'carLoan'">
        <p-tabMenu
          [model]="employmentStatus"
          class="tabdesign"
          [activeItem]="activeEmploymentStatus"
          (activeItemChange)="onActiveEmploymentStatusChange($event)"
        ></p-tabMenu>
        <ng-container
          *ngIf="activeEmploymentStatus && activeEmploymentStatus.name"
        >
          <ng-container
            *ngIf="
              activeEmploymentStatus.name == 'employed' ||
              activeEmploymentStatus.name == 'self-employed'
            "
          >
            <div class="text-capitalize">
              <p-table
                #CarleadsTable
                [value]="loanLeads"
                [sortOrder]="-1"
                (onRowSelect)="viewLead($event)"
                [lazy]="true"
                selectionMode="single"
                (onLazyLoad)="
                  activeEmploymentStatus.name == 'employed'
                    ? loadLeadsforCar($event)
                    : loadLeadsforCarself($event)
                "
                dataKey="id"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 25, 50]"
                [paginator]="true"
                [rows]="10"
                class="p-datatable-striped"
                [totalRecords]="
                  activeEmploymentStatus.name == 'employed'
                    ? carloanLeadsCount
                    : carloanselfLeadsCount
                "
                [loading]="loadleadsloading"
                responsiveLayout="scroll"
                scrollHeight="flex"
                [globalFilterFields]="[
                  'referenceNo',
                  'customer.firstName',
                  'partner.partnerName',
                  'status'
                ]"
                styleClass="p-datatable-customers "
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} leads"
              >
                <ng-template pTemplate="caption">
                  <div class="row">
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div class="p-inputgroup">
                        <input
                          type="text"
                          pInputText
                          [placeholder]="
                            activeEmploymentStatus.name === 'employed'
                              ? 'Search Lead with Person Name'
                              : 'Search Lead with Business Name'
                          "
                          [(ngModel)]="searchInputValue"
                          (ngModelChange)="handleInputChange($event)"
                          (keyup.enter)="filterBasedOnEmploymentStatus()"
                        />
                        <!-- <button
                          type="button"
                          pButton
                          icon="pi pi-search"
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        ></button> -->
                        <!-- <button
                          type="button"
                          pButton
                          class="p-button-primary"
                          [disabled]="!searchInputValue"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="assets/images/icons/search.svg"
                            alt="Search"
                            width="16"
                            height="16"
                            style="vertical-align: middle"
                          />
                        </button> -->
                        <span
                          class="input-group-text p-button-primary"
                          (click)="filterBasedOnEmploymentStatus()"
                        >
                          <img
                            src="../../../assets/images/icons/search.svg"
                            alt="Search"
                            style="width: 14px; height: 14px; cursor: pointer"
                          />
                        </span>
                      </div>
                    </div>
                    <div
                      class="col-md-3 mt-2 no-padding-small"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType == '3'
                      "
                    ></div>
                    <div class="col-md-3 mt-2 no-padding-small">
                      <div
                        class="p-inputgroup"
                        *ngIf="
                          userDetails &&
                          userDetails.userType &&
                          userDetails.userType != '3'
                        "
                      >
                        <br class="d-lg-none d-md-none" />
                        <p-dropdown
                          styleClass="text-left"
                          [style]="{ width: '100%' }"
                          [options]="leadUsers"
                          (onChange)="
                            activeEmploymentStatus.name === 'employed'
                              ? statusChangeForCar($event)
                              : statusChangeForCarSelf($event)
                          "
                          [dropdownIcon]="'pi pi-chevron-down'"
                          [(ngModel)]="SourcedByForCar"
                          optionLabel="name"
                          dataKey="name"
                          [filter]="true"
                          appendTo="body"
                          filterPlaceholder="Search..."
                        >
                        </p-dropdown>
                      </div>
                    </div>
                    <div class="col-md-3 mt-2 no-padding-small text-right">
                      <div class="d-flex">
                        <div class="flex-grow-1 me-2">
                          <p-dropdown
                            styleClass="text-left"
                            [style]="{ width: '100%' }"
                            [options]="leadStatus"
                            (onChange)="
                              activeEmploymentStatus.name === 'employed'
                                ? statusChangeForCar($event)
                                : statusChangeForCarSelf($event)
                            "
                            [dropdownIcon]="'pi pi-chevron-down'"
                            [(ngModel)]="selectedCarLeadStatus"
                            optionLabel="displayName"
                            dataKey="name"
                            appendTo="body"
                          >
                          </p-dropdown>
                        </div>
                        <div class="d-flex align-items-center pointer-cursor">
                          <app-filter
                            [position]="'right'"
                            [iconColor]="'#33009C'"
                            [iconSize]="'28px!important'"
                            (filterEvent)="
                              activeEmploymentStatus.name === 'employed'
                                ? applyConfigFilters($event, 'Home')
                                : applyConfigFilters($event, 'Homeself')
                            "
                            [filterConfig]="
                              activeEmploymentStatus.name === 'employed'
                                ? HomefilterConfig
                                : HomeSelffilterConfig
                            "
                            [showFilterIndication]="
                              activeEmploymentStatus.name === 'employed'
                                ? appliedFilterHome
                                : appliedFilterHomeself
                            "
                            pTooltip="Filter"
                            tooltipPosition="top"
                          >
                          </app-filter>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th class="text-nowrap">Lead Id</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Applicant Name
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Name
                    </th>
                    <th *ngIf="activeEmploymentStatus.name === 'employed'">
                      Designation
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Entity
                    </th>
                    <th *ngIf="activeEmploymentStatus.name === 'employed'">
                      Salary
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Contact Person
                    </th>
                    <th class="text-nowrap">Primary Phone</th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'employed'"
                    >
                      Car Type
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="activeEmploymentStatus.name === 'self-employed'"
                    >
                      Business Turnover
                    </th>
                    <th
                      class="text-nowrap"
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      Sourced By
                    </th>
                    <th class="text-nowrap">Created Date</th>
                    <th>Status</th>
                    <th class="text-nowrap">Quick Actions</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-lead>
                  <tr [pSelectableRow]="lead">
                    <td class="leadid">
                      <span class="table-column-data singleline">{{
                        lead.customId || "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data singleline">{{
                        lead.contactPerson
                          ? (lead.contactPerson | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data singleline">{{
                        lead.businessName
                          ? (lead.businessName | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data singleline">{{
                        lead.designation
                          ? (lead.designation | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data">{{
                        lead.businessEntity
                          ? getEntityName(lead.businessEntity)
                          : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data">{{
                        lead.salary ? lead.salary : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data singleline">{{
                        lead.contactPerson
                          ? (lead.contactPerson | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data">{{
                        lead.primaryPhone ? lead.primaryPhone : "-"
                      }}</span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'employed'">
                      <span class="table-column-data">
                        <!-- {{
                        lead.carType ? lead.carType : "-"
                      }} -->
                        {{
                          lead.carType
                            ? (getCarType(lead.carType) | capitalizeFirst)
                            : "-"
                        }}
                    </span>
                    </td>
                    <td *ngIf="activeEmploymentStatus.name === 'self-employed'">
                      <span class="table-column-data">{{
                        lead.businessTurnover ? lead.businessTurnover : "-"
                      }}</span>
                    </td>
                    <td
                      *ngIf="
                        userDetails &&
                        userDetails.userType &&
                        userDetails.userType != '3'
                      "
                    >
                      <span class="table-column-data singleline">{{
                        lead.sourcedByName
                          ? (lead.sourcedByName | capitalizeFirst)
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <span class="table-column-data">{{
                        lead.createdOn
                          ? (lead.createdOn | date : "mediumDate")
                          : "-"
                      }}</span>
                    </td>
                    <td>
                      <!-- <span
                        class="table-column-data fw-bold statusdata"
                        [ngStyle]="{
                          color: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).textColor,

                        }"
                      >
                        {{ getStatusName(lead.leadInternalStatus) }}
                      </span> -->
                      <span
                        class="d-inline-flex align-items-center justify-content-start gap-2"
                        [ngStyle]="{
                          backgroundColor: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).backgroundColor,
                          color: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).textColor,
                          height: '22px',
                          width: getStatusColor(
                            getStatusName(lead.leadInternalStatus)
                          ).width,
                          borderRadius: '16px',
                          fontSize: '12px',
                          fontWeight: 500,
                          paddingLeft: '8px'
                        }"
                      >
                        <!-- Dot -->
                        <span
                          class="rounded-circle"
                          [ngStyle]="{
                            backgroundColor: getStatusColor(
                              getStatusName(lead.leadInternalStatus)
                            ).dotColor,
                            width: '8px',
                            height: '8px',
                            display: 'inline-block'
                          }"
                        ></span>

                        <!-- Status Text -->
                        {{ getStatusName(lead.leadInternalStatus) }}
                      </span>
                    </td>
                    <td>
                      <div class="text-center">
                        <div class="d-flex tableimage">
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-primary me-2 custom-btn"
                            (click)="viewLead(lead)"
                            pTooltip="View Lead"
                            icon="fas fa-eye"
                            tooltipPosition="top"
                          ></button> -->
                          <!-- <img
                            src="../../../assets/images/icons/eye.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            tooltipPosition="top"
                            (click)="viewLead(lead)"
                            pTooltip="View Lead"
                          /> -->
                          <!-- <button
                            pButton
                            pRipple
                            type="button"
                            class="p-button-info me-2 custom-btn"
                            (click)="updateLoanLead(lead.leadId)"
                            pTooltip="Update Lead"
                            icon="fas fa-pen-to-square"
                            tooltipPosition="top"
                          ></button> -->
                          <img
                            alt="Update Lead"
                            src="../../../assets/images/icons/edit.svg"
                            width="24px"
                            height="24px"
                            class="me-2"
                            (click)="updateLoanLead(lead.leadId)"
                            pTooltip="Update Lead"
                            tooltipPosition="top"
                          />
                          <!-- <p-menu
                            appendTo="body"
                            #menuhome
                            [model]="getHomeActionItems(lead)"
                            [popup]="true"
                          ></p-menu> -->

                          <!-- <button
                            pButton
                            type="button"
                            class="custom-btn"
                            (click)="menuhome.toggle($event)"
                            icon="fas fa-bars"
                            pTooltip="Actions"
                            tooltipPosition="top"
                          ></button> -->
                          <!-- <img
                            alt="Actions"
                            src="../../../assets/images/icons/menu.svg"
                            width="24px"
                            height="24px"
                            pTooltip="Actions"
                            tooltipPosition="top"
                            (click)="
                              menuhome.toggle($event); $event.stopPropagation()
                            "
                          /> -->

                          <div *ngIf="activeEmploymentStatus.name === 'employed'">
                            <div *ngIf="userDetails.userType !==3">
                            <div *ngIf="lead.leadInternalStatus === 1">
                            <button
                            [matMenuTriggerFor]="menu"
                            aria-label="Actions"
                            style="all: unset; cursor: pointer"
                          >
                            <img
                              alt="Actions"
                              src="assets/images/icons/menu.svg"
                              width="24"
                              height="24"
                            />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'car')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/Archive.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Archive</span>
                              </button>
                              <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'car')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/sendtofiles.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Files</span>
                              </button>
                            </mat-menu>
                            </div>
                            <div *ngIf="lead.leadInternalStatus === 2">
                              <button
                              [matMenuTriggerFor]="menu"
                              aria-label="Actions"
                              style="all: unset; cursor: pointer"
                            >
                              <img
                                alt="Actions"
                                src="assets/images/icons/menu.svg"
                                width="24"
                                height="24"
                              />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'car')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/leads.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send to New Lead</span>
                              </button>
                            </mat-menu>
                            </div>
                          </div>
                          </div>
                          <div *ngIf="activeEmploymentStatus.name === 'self-employed'">
                            <div *ngIf="userDetails.userType !==3">
                            <div *ngIf="lead.leadInternalStatus === 1">
                            <button
                            [matMenuTriggerFor]="menu"
                            aria-label="Actions"
                            style="all: unset; cursor: pointer"
                          >
                            <img
                              alt="Actions"
                              src="assets/images/icons/menu.svg"
                              width="24"
                              height="24"
                            />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="sendLoanLeadToArchive(lead, 'carself')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/Archive.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Archive</span>
                              </button>
                              <button mat-menu-item (click)="sendLoanLeadToFiles(lead, 'carself')" class="matmenuimg"  *ngIf="userDetails.userType !== '3'">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/sendtofiles.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send To Files</span>
                              </button>
                            </mat-menu>
                            </div>
                            <div *ngIf="lead.leadInternalStatus === 2">
                              <button
                              [matMenuTriggerFor]="menu"
                              aria-label="Actions"
                              style="all: unset; cursor: pointer"
                            >
                              <img
                                alt="Actions"
                                src="assets/images/icons/menu.svg"
                                width="24"
                                height="24"
                              />
                            </button>
                            <mat-menu #menu="matMenu">
                              <button mat-menu-item (click)="revertLoanLeadToNew(lead, 'carself')" class="matmenuimg">
                                <img
                                  alt="Actions"
                                  src="assets/images/icons/leads.svg"
                                  width="24"
                                  height="24"
                                  class="mr-2 image-icon"
                                />
                                <span>Send to New Lead</span>
                              </button>
                            </mat-menu>
                            </div>
                          </div>
                          </div>                          
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr class="text-center">
                    <td colspan="10" class="text-center fw-bold">
                      <!-- <img
                        alt="No Data"
                        src="../../../assets/images/menu/no-data.gif"
                        width="200"
                        height="200"
                      /> -->
                      <p
                        style="
                          color: #535ab4;
                          font-weight: 400;
                          font-size: 18px;
                        "
                      >
                        No Leads Found
                      </p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </ng-container>
        </ng-container>
        
      </div>
      <div *ngIf="activeItem.name == 'commercialVehicleLoan'">
        <app-comming-soon></app-comming-soon>
      </div>
    </div>
  </div>
</div>
